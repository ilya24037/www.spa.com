<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тест Яндекс.Карт с маркерами Перми</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        #map {
            width: 100%;
            height: 500px;
            border: 2px solid #ccc;
            border-radius: 8px;
        }
        .info {
            margin: 20px 0;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 5px;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <h1>Тест карты с маркерами мастеров в Перми</h1>
    
    <div class="info">
        <p><strong>Тестовые координаты Перми:</strong></p>
        <ul id="coordinates-list"></ul>
    </div>
    
    <div>
        <button onclick="addSimpleMarkers()">Добавить простые маркеры</button>
        <button onclick="addMarkersWithProperties()">Добавить маркеры с свойствами</button>
        <button onclick="clearMarkers()">Очистить маркеры</button>
    </div>
    
    <div id="map"></div>

    <!-- Подключение API Яндекс.Карт -->
    <script src="https://api-maps.yandex.ru/2.1/?apikey=1220b4af-ae8e-4506-ab3a-c6329234066f&lang=ru_RU"></script>
    
    <script>
        let myMap;
        let markers = [];
        
        // Тестовые координаты мастеров в Перми
        const testMarkers = [
            { lat: 58.0078, lng: 56.2324, title: 'Дмитрий Козлов' },
            { lat: 58.0150, lng: 56.2465, title: 'Елена Сидорова' },
            { lat: 58.0092, lng: 56.2270, title: 'Анна Петрова' },
            { lat: 58.0105, lng: 56.2502, title: 'Михаил Иванов' },
            { lat: 58.0112, lng: 56.2589, title: 'Ольга Николаева' }
        ];
        
        // Показываем координаты в списке
        const list = document.getElementById('coordinates-list');
        testMarkers.forEach((marker, index) => {
            const li = document.createElement('li');
            li.textContent = `${marker.title}: [${marker.lat}, ${marker.lng}]`;
            list.appendChild(li);
        });
        
        // Инициализация карты после загрузки API
        ymaps.ready(init);
        
        function init() {
            console.log('Инициализация карты...');
            
            // Создание карты
            myMap = new ymaps.Map("map", {
                center: [58.0105, 56.2502], // Центр Перми
                zoom: 12,
                controls: ['zoomControl', 'searchControl']
            });
            
            console.log('Карта создана');
            
            // Автоматически добавляем простые маркеры
            setTimeout(() => {
                addSimpleMarkers();
            }, 1000);
        }
        
        function addSimpleMarkers() {
            console.log('Добавляем простые маркеры...');
            clearMarkers();
            
            testMarkers.forEach((markerData, index) => {
                try {
                    // Самый простой способ создания маркера
                    const placemark = new ymaps.Placemark([markerData.lat, markerData.lng]);
                    
                    // Добавляем на карту
                    myMap.geoObjects.add(placemark);
                    markers.push(placemark);
                    
                    console.log(`Маркер ${index + 1} добавлен: ${markerData.title}`);
                } catch (error) {
                    console.error(`Ошибка добавления маркера ${index + 1}:`, error);
                }
            });
        }
        
        function addMarkersWithProperties() {
            console.log('Добавляем маркеры с свойствами...');
            clearMarkers();
            
            testMarkers.forEach((markerData, index) => {
                try {
                    // Маркер с свойствами (второй параметр)
                    const placemark = new ymaps.Placemark(
                        [markerData.lat, markerData.lng],
                        {
                            hintContent: markerData.title,
                            balloonContent: `<strong>${markerData.title}</strong><br>Мастер массажа`
                        }
                    );
                    
                    // Добавляем на карту
                    myMap.geoObjects.add(placemark);
                    markers.push(placemark);
                    
                    console.log(`Маркер с свойствами ${index + 1} добавлен: ${markerData.title}`);
                } catch (error) {
                    console.error(`Ошибка добавления маркера ${index + 1}:`, error);
                }
            });
        }
        
        function clearMarkers() {
            markers.forEach(marker => {
                myMap.geoObjects.remove(marker);
            });
            markers = [];
            console.log('Маркеры удалены');
        }
    </script>
</body>
</html>