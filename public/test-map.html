<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –∫–∞—Ä—Ç—ã –Ø–Ω–¥–µ–∫—Å</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: #f5f5f5; 
        }
        .container { 
            max-width: 800px; 
            margin: 0 auto; 
            background: white; 
            padding: 20px; 
            border-radius: 8px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
        }
        .map-container { 
            width: 100%; 
            height: 400px; 
            border: 2px solid #ddd; 
            border-radius: 8px; 
            margin: 20px 0; 
            position: relative;
        }
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #666;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        .log { 
            background: #f8f9fa; 
            border: 1px solid #dee2e6; 
            padding: 15px; 
            border-radius: 4px; 
            font-family: monospace; 
            max-height: 300px; 
            overflow-y: auto;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üó∫Ô∏è –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–∞—Ä—Ç—ã –Ø–Ω–¥–µ–∫—Å</h1>
        
        <div id="status" class="status info">
            –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–∞...
        </div>

        <div class="map-container">
            <div id="test-map" style="width: 100%; height: 100%;"></div>
            <div id="loading" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ä—Ç—ã...</div>
        </div>

        <div>
            <h3>–õ–æ–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:</h3>
            <div id="log" class="log">–ó–∞–ø—É—Å–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏...\n</div>
        </div>

        <div>
            <button onclick="testMap()" style="padding: 10px 20px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">
                –¢–µ—Å—Ç –∫–∞—Ä—Ç—ã
            </button>
            <button onclick="clearLog()" style="padding: 10px 20px; margin: 5px; background: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer;">
                –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥
            </button>
        </div>
    </div>

    <script>
        const API_KEY = '23ff8acc-835f-4e99-8b19-d33c5d346e18';
        const PERM_CENTER = { lat: 58.0105, lng: 56.2502 };
        
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            const logElement = document.getElementById('log');
            logElement.textContent += `[${timestamp}] ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
            console.log(`üó∫Ô∏è ${message}`);
        }

        function setStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
        }

        function clearLog() {
            document.getElementById('log').textContent = '–õ–æ–≥ –æ—á–∏—â–µ–Ω...\n';
        }

        // –ü—Ä–æ—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ Yandex Maps (–∫–∞–∫ –≤ —Å—Ç–∞—Ä–æ–º –∫–æ–¥–µ)
        function loadYandexMaps() {
            return new Promise((resolve, reject) => {
                log('–ù–∞—á–∏–Ω–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É Yandex Maps API...');
                
                if (window.ymaps && window.ymaps.ready) {
                    log('API —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω, –≤—ã–∑—ã–≤–∞–µ–º ready()');
                    window.ymaps.ready(() => {
                        log('ymaps.ready() –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ');
                        resolve();
                    });
                    return;
                }

                log('–°–æ–∑–¥–∞–µ–º —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ API');
                const script = document.createElement('script');
                script.src = `https://api-maps.yandex.ru/2.1/?lang=ru_RU&apikey=${API_KEY}`;
                
                script.onload = () => {
                    log('–°–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∂–µ–Ω, –∂–¥–µ–º ymaps.ready()');
                    window.ymaps.ready(() => {
                        log('ymaps.ready() –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ');
                        resolve();
                    });
                };
                
                script.onerror = () => {
                    const error = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–∞ Yandex Maps';
                    log(error);
                    reject(new Error(error));
                };
                
                document.head.appendChild(script);
                log('–°–∫—Ä–∏–ø—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ head');
            });
        }

        async function testMap() {
            try {
                setStatus('–¢–µ—Å—Ç–∏—Ä—É–µ–º –∫–∞—Ä—Ç—É...', 'info');
                log('=== –ù–ê–ß–ê–õ–û –¢–ï–°–¢–ê –ö–ê–†–¢–´ ===');
                
                // –®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∫–∞ API
                log('–®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∫–∞ Yandex Maps API');
                await loadYandexMaps();
                log('‚úÖ API –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ');
                
                // –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
                log('–®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∫–∞—Ä—Ç—ã');
                const container = document.getElementById('test-map');
                if (!container) {
                    throw new Error('–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–∞—Ä—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω');
                }
                log('‚úÖ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞–π–¥–µ–Ω');
                
                // –®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã
                log('–®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã');
                const map = new window.ymaps.Map('test-map', {
                    center: [PERM_CENTER.lat, PERM_CENTER.lng],
                    zoom: 15,
                    controls: ['zoomControl', 'typeSelector'],
                    behaviors: ['default']
                });
                
                log('‚úÖ –ö–∞—Ä—Ç–∞ —Å–æ–∑–¥–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ');
                
                // –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞—Ä—Ç—ã
                log('–®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞—Ä—Ç—ã');
                map.options.set('minZoom', 10);
                map.options.set('maxZoom', 18);
                
                // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
                document.getElementById('loading').style.display = 'none';
                
                log('‚úÖ –ö–∞—Ä—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ');
                log('=== –¢–ï–°–¢ –ó–ê–í–ï–†–®–ï–ù –£–°–ü–ï–®–ù–û ===');
                setStatus('‚úÖ –ö–∞—Ä—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ!', 'success');
                
            } catch (error) {
                log(`‚ùå –û–®–ò–ë–ö–ê: ${error.message}`);
                log(`=== –¢–ï–°–¢ –ó–ê–í–ï–†–®–ï–ù –° –û–®–ò–ë–ö–û–ô ===`);
                setStatus(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', () => {
            log('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            setTimeout(testMap, 1000); // –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
        });
    </script>
</body>
</html>