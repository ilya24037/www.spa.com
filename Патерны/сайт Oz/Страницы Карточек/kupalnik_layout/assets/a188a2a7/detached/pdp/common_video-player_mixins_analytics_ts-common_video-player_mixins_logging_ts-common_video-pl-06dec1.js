"use strict";(self.webpackChunkDetached_pdp=self.webpackChunkDetached_pdp||[]).push([["common_video-player_mixins_analytics_ts-common_video-player_mixins_logging_ts-common_video-pl-06dec1"],{"0997d":(e,t,n)=>{n.d(t,{W:()=>o,k:()=>r});var r=function(e){return e.OTHER="other",e.REVIEW_PREVIEW="review-preview",e.TILE="tile",e.ADV="advertisement",e.REVIEW="review",e.GALLERY="gallery",e}({}),o={[r.GALLERY]:"cdn_video_pdp_hostname",[r.TILE]:"cdn_video_tile_hostname",[r.REVIEW]:"cdn_video_review_hostname",[r.REVIEW_PREVIEW]:"cdn_video_review_hostname",[r.OTHER]:"cdn_video_hostname"}},f0f9e:(e,t,n)=>{var r=n("1dcb5"),o=n("16477"),h=n("0997d");t.Z={props:{sendVideoPlatformAnalyticsEvents:{type:Boolean,default:!0},productType:{type:String,default:h.k.OTHER,validator:e=>[h.k.OTHER,h.k.REVIEW_PREVIEW,h.k.TILE,h.k.ADV,h.k.REVIEW,h.k.GALLERY].includes(e)},cellTrackingInfo:{type:Object,default:()=>({})},widgetName:{type:String,default:"unknown"},externalMeta:{type:Object,default:()=>({})}},watch:{isPlayerObjectAttached(e){e&&this.initAnalyticsListeners()}},computed:{metricsEventsMeta(){return Object.assign(Object.assign({},this.externalMeta),{},{mediaPlayerInit:Object.assign(Object.assign({},this.externalMeta&&this.externalMeta.mediaPlayerInit),{},{productType:this.productType,widgetName:this.widgetName})})}},inject:{isMobile:{default:!1},trackerSend:{default:()=>()=>{}}},methods:{initAnalyticsListeners(){this.sendVideoPlatformAnalyticsEvents&&(this.player.on(r.rg.ViewStart,this.onViewStart),this.player.on(r.rg.ViewFinish,this.onViewFinish),this.player.on(r.rg.Rewind,this.onRewind)),window.addEventListener("beforeunload",this.onBeforeUnload)},onViewStart(e){if(this.cellTrackingInfo&&this.cellTrackingInfo.videoView){var t={trinityEvent:{cellToken:this.cellTrackingInfo.videoView,custom:e}};this.trackerSend(o.EActionTypes.VIDEO_VIEW_START,t)}},onViewFinish(e){if(this.cellTrackingInfo&&this.cellTrackingInfo.videoViewFinish){var t={trinityEvent:{cellToken:this.cellTrackingInfo.videoViewFinish,custom:e}};this.trackerSend(o.EActionTypes.VIDEO_VIEW_FINISH,t)}},onRewind(e){if(this.cellTrackingInfo&&this.cellTrackingInfo.videoRewind){var t={trinityEvent:{cellToken:this.cellTrackingInfo.videoRewind,custom:e}};this.trackerSend(o.EActionTypes.VIDEO_REWIND,t)}},onBeforeUnload(){this.sendVideoPlatformAnalyticsEvents&&this.sendViewFinishEvent(r.kE.DestroyComponent)},sendViewFinishEvent(e){if(this.player&&this.cellTrackingInfo&&this.cellTrackingInfo.videoViewFinish){var t={number:this.player.viewDuration,status:e},n={trinityEvent:{cellToken:this.cellTrackingInfo.videoRewind,custom:t}};this.trackerSend(o.EActionTypes.VIDEO_VIEW_FINISH,n)}}},beforeDestroy(){this.sendVideoPlatformAnalyticsEvents&&!this.showExpandControl&&this.sendViewFinishEvent(r.kE.DestroyComponent),this.player&&(this.player.off(r.rg.ViewStart,this.onViewStart),this.player.off(r.rg.ViewFinish,this.onViewFinish),this.player.off(r.rg.Rewind,this.onRewind)),window.removeEventListener("beforeunload",this.onBeforeUnload)}}},"3ccd9":(e,t,n)=>{var r=n("ecabc");t.Z={mixins:[(0,r.composerStateMixin)({enableVideoLogs:e=>e._get("experimentsConfig.enableVideoLogs",!1)})],methods:{logVideoError(e){if(e instanceof Event&&"error"===e.type&&e.stopPropagation(),this.enableVideoLogs){var{fatal:t,message:n,identifier:r,errorType:o}=e.detail;this.$logger.error({message:(o||"")+(o&&n&&". ")+(n||"")||"Unknown error in video-player",zone:"video-player",payload:Object.assign({fatal:t,identifier:r,productType:this.productType,src:this.videoUrl},this.loggingPayload),widget:this.widgetName},{isStaticLogs:!0})}}}}},"1e564":(e,t,n)=>{n.d(t,{Z:()=>h});var r=n("0997d");var o=n("ecabc"),h={computed:{videoUrl(){return function(e,t,n){try{var o=e[r.W[n]]||e[r.W[r.k.OTHER]];if(o){var h=new URL(t);return h.hostname=o,h.toString()}return t}catch(e){}return t}((0,o.useComposerStore)(this).state._get("resolveParams"),this.src,this.productType)}}}},"9311e":(e,t,n)=>{n.d(t,{v:()=>o});var r=n("69aed");class o extends r.AbstractStoreService{getInitialState(){return{videos:{}}}setVideoData(e,t){this.pushState(n=>{n.videos[e]=t})}}o.__serviceName="AbstractStoreService_ServiceWorkerInstance"}}]);