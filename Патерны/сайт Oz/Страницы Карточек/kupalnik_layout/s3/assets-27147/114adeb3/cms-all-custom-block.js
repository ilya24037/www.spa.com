"use strict";(self.webpackChunkMicrofront_catalog_menu_cms_uw=self.webpackChunkMicrofront_catalog_menu_cms_uw||[]).push([["cms-all-custom-block"],{bea83:(t,e,o)=>{o.a(t,async(t,n)=>{try{var r=o("79a44"),c=o("abb9e"),l=o.n(c),h=o("ed0be"),d=o("ecabc"),m=o("3cd7c"),v=t([h,m]);[h,m]=v.then?(await v)():v;var{AuthorizationServiceMixin:y,loadFiles:f}=(t=>{var e,o;(o=e||(e={})).MODAL="modal",o.REDIRECT="redirect";var n={methods:{async redirectToAuth(t){await this.$composerRouter.redirect(t,"_self")},async showAuthForm(t){var{method:o,url:n}=await this._getAuthMethodData(t);o===e.REDIRECT?await this.redirectToAuth(n):this.$registry.useByName("ComposerActions").getModal({url:n,options:{notCentered:!0}})},async _getAuthMethodData(t){var e={name:"authorizationMethod"};t&&(e.query={redirect_uri:t});var{method:o,url:n}=await this.$registry.useByName("ComposerService").actionGet(e);return{method:o,url:n}}}};async function r({filePath:t,nonce:e,absolute:o=!1,isCrossoriginAnonymous:n}){return new Promise(r=>{var c=document.getElementsByTagName("head")[0]||document.documentElement,l=-1!==t.indexOf(".css");0===t.indexOf("//")||0!==t.indexOf("/")||o||(t=document.location.host+t),o||(t=((t="")=>{var e;return-1===t.indexOf("http")&&(e="undefined"==typeof document?"https:":document.location.protocol,-1===t.indexOf("//")&&(e+="//"),t=e+t),t})(t));var h=l?function(path,t){var link=document.createElement("link");return link.type="text/css",link.rel="stylesheet",link.media="screen",link.href=path,t&&link.setAttribute("nonce",t),link}(t,e):function(path,t,e=!0,o){var script=document.createElement("script");return script.async=e,script.src=path,t&&script.setAttribute("nonce",t),o&&script.setAttribute("crossorigin","anonymous"),script}(t,e,!o,n);h.addEventListener("load",()=>{r(h)}),c.appendChild(h)})}return t.AuthorizationServiceMixin=n,t.loadFiles=async function({fileList:t,loadAsync:e=!1,absolute:o=!1,nonce:n,isCrossoriginAnonymous:c=!1}){return new Promise((l,h)=>{t=t instanceof Array?t:[t],e?Promise.all(function({fileList:t,nonce:e,absolute:o=!1,isCrossoriginAnonymous:n}){var c=[];return t.forEach(t=>{c.push(r({filePath:t,nonce:e,absolute:o,isCrossoriginAnonymous:n}))}),c}({fileList:t,nonce:n,absolute:o,isCrossoriginAnonymous:c})).then(l).catch(h):async function({fileList:t,nonce:e,absolute:o=!1,isCrossoriginAnonymous:n}){for(var c=[],i=0;i<t.length;i++){var l=await r({filePath:t[i],nonce:e,absolute:o,isCrossoriginAnonymous:n});c.push(l)}return c}({fileList:t,nonce:n,absolute:o,isCrossoriginAnonymous:c}).then(l).catch(h)})},t})({}),w={};e.Z=l().extend({name:"CustomBlock",computed:{mountName(){return`${this.widgetState.component}:${this.widgetState.version}`},styleBlocks(){if(this.needCssImport){var{css:t=[]}=this.widgetState,e="";return t.forEach(element=>{e+=`@import url('${this.cdnStaticHostname+element}');`}),"<style>"+e+"</style>"}},styleChunks(){if(this.needCssInline){var{cssChunks:t}=this.widgetState,e="";if(t)for(var o in t)e+=`<style type='text/css' data-href='${this.cdnStaticHostname+o}'>${t[o]}</style>\n`;return e}},cdnStaticHostname(){var{publicPath:t=""}=this.widgetState,e=(0,d.useComposerStore)(this).state._get("resolveParams.cdn_static_hostname","st.ozone.ru");return t.replace(/^(?:https?:\/\/)?(?:[^@/]+@)?([^:/]+)\//gi,`https://${e}/`)},cssMap(){var{css:t=[],publicPath:e=""}=this.widgetState,map={};return t.forEach(t=>{var path=`${e+t}`,o=`${this.cdnStaticHostname+t}`;map[path]=1,map[o]=1}),map}},data:()=>({needCssImport:!1,needCssInline:!1}),mixins:[m.DefaultAtomActionsMixin,y],methods:{loadFiles:f,async addFile(t){if(w[t])return!1;w[t]=await this.loadFiles({fileList:t,loadAsync:!0,absolute:!1,isCrossoriginAnonymous:!0})},async loadResources(t){for(var i=0;i<t.length;i++)await this.addFile([this.cdnStaticHostname,t[i]].join(""))},async toogleModalLogin(){await this.showAuthForm()},callAction(...t){this.onAtomAction(...t)},showNotification({detail:t}){r.registry.use(h.NotificationsActions).createNewNotificationDeprecated(t)},setLocalizationData(){var{localizationData:t}=this.widgetState;t&&window&&(window.__customBlocksExtras__||(window.__customBlocksExtras__={localizationData:{}}),window.__customBlocksExtras__.localizationData=Object.assign(Object.assign({},window.__customBlocksExtras__.localizationData),t))}},beforeMount(){this.setLocalizationData();var t=document.head.querySelectorAll("style");if(!Array.from(t).find(t=>this.cssMap[t.getAttribute("data-href")])){var e=document.head.querySelectorAll("link");Array.from(e).find(t=>this.cssMap[t.getAttribute("href")])||(this.widgetState.cssChunks?this.needCssInline=!0:this.needCssImport=!0)}},async mounted(){var{js:t=[]}=this.widgetState;t.length&&await this.loadResources(t),this.$refs.customBlock.addEventListener("toogleModalLogin",this.toogleModalLogin,!0),this.$refs.customBlock.addEventListener("callAction",this.callAction,!0),this.$refs.customBlock.addEventListener("notification",this.showNotification,!0),this.endRouteLoading(()=>this.$refs.customBlock.dispatchEvent(new CustomEvent("endRouteLoading")))},destroyed(){this.$refs.customBlock&&(this.$refs.customBlock.removeEventListener("toogleModalLogin",this.toogleModalLogin,!0),this.$refs.customBlock.removeEventListener("callAction",this.callAction,!0),this.$refs.customBlock.removeEventListener("notification",this.showNotification,!0))}}),n()}catch(t){n(t)}})},"431ec":(t,e,o)=>{o.a(t,async(t,n)=>{try{o.r(e);var r=o("381e7"),c=o("09168"),l=o("695d8"),h=o.n(l),d=t([c]);c=(d.then?(await d)():d)[0];var component=h()(c.Z,r.s,r.x,!1,null,null,null);e.default=component.exports,n()}catch(t){n(t)}})},"09168":(t,e,o)=>{o.a(t,async(t,n)=>{try{var r=o("bea83"),c=t([r]);r=(c.then?(await c)():c)[0],e.Z=r.Z,n()}catch(t){n(t)}})},"381e7":(t,e,o)=>{o.d(e,{s:()=>n,x:()=>r});var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{ref:"customBlock",attrs:{id:"customBlock"}},[t.styleBlocks?o("div",{directives:[{name:"html-deprecated",rawName:"v-html-deprecated",value:t.styleBlocks,expression:"styleBlocks"}]}):t._e(),t._v(" "),t.styleChunks?o("div",{directives:[{name:"html-deprecated",rawName:"v-html-deprecated",value:t.styleChunks,expression:"styleChunks"}]}):t._e(),t._v(" "),o("div",{directives:[{name:"html-deprecated",rawName:"v-html-deprecated",value:t.widgetState.html,expression:"widgetState.html"}],attrs:{"data-custom-block":t.mountName}})])},r=[]}}]);