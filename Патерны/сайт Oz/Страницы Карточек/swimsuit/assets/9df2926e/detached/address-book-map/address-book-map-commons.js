(self.webpackChunkDetached_address_book_map=self.webpackChunkDetached_address_book_map||[]).push([["address-book-map-commons"],{b0abf:(t,e,r)=>{"use strict";r.d(e,{$M:()=>h,Aj:()=>l,lm:()=>c,nj:()=>v,zw:()=>f});var n=r("30e10"),o=r("ecabc"),c=function(t){return t.MAP_INIT="MAP_INIT",t.MAP_INIT_RUNTIME="MAP_INIT_RUNTIME",t}({}),f=function(t){return t.MAP_SWIPE="MAP_SWIPE",t.MAP_ZOOM="MAP_ZOOM",t.MAP_ADDRESS_SELECT="MAP_ADDRESS_SELECT",t.MAP_CHANGE_MODE="MAP_CHANGE_MODE",t}({});function v(t,e={},r){var v=(0,o.useComposerStore)(r).state,h=v._get("experimentsConfig.trackMapEventActions")||!1,l=v._get("experimentsConfig.trackMapInitActions")||!1;t in c&&l&&(0,n.HC)(t,e),t in f&&h&&(0,n.HC)(t,e)}function h(t,e){var r=(0,o.useComposerStore)(e).state,v=r._get("experimentsConfig.trackMapEventActions")||!1,h=r._get("experimentsConfig.trackMapInitActions")||!1;t in c&&h&&(0,n.zL)(t),t in f&&v&&(0,n.zL)(t)}var l=["modal%2FcommonDelivery","azimuth","gocheckout%2Fdelivery","validateCourierAddressV2"];var d=new class{constructor(){this.id=0,this.task=void 0,this.map=void 0,this.performanceEvent=[],this.boundsChangeHandler=null}initialize(map){this.map||(this.map=map,this.setupObserver(this.map))}setupObserver(map){this.id=0,this.task=new Promise(t=>{map.subscribeOnce("metrics.viewport-ready",()=>{t({success:0===this.id})})}),this.boundsChangeHandler=()=>{var t=++this.id;this.task=new Promise(e=>{map.subscribeOnce("metrics.viewport-loaded",()=>{e({success:this.id===t})})})},map.subscribe("bounds-change-end",this.boundsChangeHandler)}getTask(){return this.task}reset(){this.map&&this.boundsChangeHandler&&this.map.unsubscribe("bounds-change-end",this.boundsChangeHandler),this.id=0,this.task=null,this.map=null,this.boundsChangeHandler=null}addEvent(t){this.performanceEvent.includes(t)||this.performanceEvent.push(t)}sendPerformanceActionsEvent(t=null){for(var e of this.performanceEvent)switch(e){case f.MAP_SWIPE:h(f.MAP_SWIPE,t);break;case f.MAP_ZOOM:h(f.MAP_ZOOM,t);break;case f.MAP_ADDRESS_SELECT:h(f.MAP_ADDRESS_SELECT,t);break;case f.MAP_CHANGE_MODE:h(f.MAP_CHANGE_MODE,t)}this.clearPerformanceEvents()}clearPerformanceEvents(){this.performanceEvent.length=0}};e.ZP=d},"8838a":(t,e,r)=>{"use strict";var n=r("ce27b"),o=r.n(n),c=r("79a44"),f=r("46c81"),v=r("5462a"),h=r("0af63"),l=r("39970"),d=r("97511"),m=r("b0abf"),{ESnackBarPositions:k}=(t=>{var e=(t=>(t.BOTTOM_RIGHT="bottom-right",t.BOTTOM_CENTER="bottom-center",t.BOTTOM_LEFT="bottom-left",t.TOP_RIGHT="top-right",t.TOP_CENTER="top-center",t.TOP_LEFT="top-left",t.CUSTOM="custom",t))(e||{});return t.ESnackBarPositions=e,t})({});e.Z={name:"CheckoutMapMixin",mixins:[l.$],data:()=>({SnackBarPositions:k}),inject:{isMobile:{default:!1}},methods:{getCurrentState(t){var e=c.registry.use(d.K).state._get("data",{});if(t&&t.length){var r={};return t.forEach(t=>{r=Object.assign(Object.assign({},r),{[t]:e[t]})}),r}return e},async updateLayoutOrThrowRestriction(t){var{res:e}=await this.updateLayout(t);if(e){var{customTplLink:r,restriction:n,viewport:f}=e;if(n){var{message:h,title,action:d,trackingInfo:m,coords:k,lifetime:M,position:y}=n,O={type:v.NotificationTypes.ERROR,content:h,title,coords:k,position:this.SnackBarPositions[y],infinity:"infinite"===M,button:null};d&&(O.button={text:d.title,action:()=>this.onAtomAction(d,m)}),await c.registry.use(v.NotificationsActions).createNewNotificationDeprecated(O);var j=o()(e,"trackingInfo.view",null);j&&this.trackerSend(j)}else if(r&&f){var A=[[f.leftBottom.latitude,f.leftBottom.longitude],[f.rightTop.latitude,f.rightTop.longitude]];this.CheckoutCrossEventsInstance.emit(l.H.MOVE_MAP_TO_BOUNDS,{bounds:A,tplLink:r})}else if(f){var C=[[f.leftBottom.latitude,f.leftBottom.longitude],[f.rightTop.latitude,f.rightTop.longitude]];this.CheckoutCrossEventsInstance.emit(l.H.MOVE_MAP_TO_BOUNDS,{bounds:C})}}},async updateLayout(t){var{action:e,data=null,trackingInfo:r=null,stateKeys:n=[],routerParams:o={},replaceUrl:c=!1,needPostBody:f=!0}=t;return this.sendRequest(e,data,r,n,o,c,f)},sendRequest(t,data,e,r,n,v,l){if("_blank"===o()(t,"params.target")||t.behavior!==h.AtomActionBehaviour.ComposerNestedPage&&t.behavior!==h.AtomActionBehaviour.Redirect)return this.onAtomAction(t,e);if(t.link){var d=t.behavior===h.AtomActionBehaviour.ComposerNestedPage?"getModal":"getLayout",m={};l&&(m=Object.assign(Object.assign({},data),this.getCurrentState(r)));var k={};return o()(t,"params.closeButtonPosition","")||(k=t.behavior===h.AtomActionBehaviour.ComposerNestedPage?{closeButtonPosition:this.isMobile?"inside":"outside"}:{}),this.sendAnalyticsEvent(e),c.registry.use(f.ComposerActions)[d](Object.assign(Object.assign({url:t.link,method:"post",payload:m,options:Object.assign(Object.assign({},t.params),k),routerMethod:"replace",replaceUrl:v||this.replaceUrl},n),{},{useUpdateComposerLayout:t.behavior===h.AtomActionBehaviour.ComposerNestedPage}))}},getMapAction(t){var e=o()(t,"link")&&t.link.startsWith("/modal")?h.AtomActionBehaviour.ComposerNestedPage:h.AtomActionBehaviour.Redirect;return Object.assign(Object.assign({},t),{},{behavior:e})},sendAnalyticsEvent(t,e="click"){var r=o()(t,e,null);r&&this.trackerSend(r)},async subscribeToSdkMapViewportLoaded(){var t=m.ZP.getTask();t&&((await t).success&&m.ZP.sendPerformanceActionsEvent(this))}}}},f1f14:(t,e,r)=>{"use strict";r.d(e,{R:()=>c});var n=r("8838a"),o=r("0af63"),c={mixins:[o.DefaultAtomActionsMixin,n.Z]}},97511:(t,e,r)=>{"use strict";r.d(e,{K:()=>o});var n=r("69aed");class o extends n.AbstractStoreService{getInitialState(){return{}}setDataForm(form){this.pushState(t=>{t.data||(t.data={}),t.data.form=form})}setDataMap(map){this.pushState(t=>{t.data||(t.data={}),t.data.map=map})}mergeDataGeolocation(t){this.pushState(e=>{e.data||(e.data={}),e.data.geolocation=Object.assign(e.data.geolocation||{},t)})}setYandexMapsAPI(t){this.pushState(e=>{e.yandexMapsAPI=t})}setFlags(t){this.pushState(e=>{for(var r in t){var n=r;e[n]=t[n]}})}}o.__serviceName="AbstractStoreService_CheckoutDeliveryStore"},39970:(t,e,r)=>{"use strict";r.d(e,{$:()=>c,H:()=>o.H});var n=r("79a44"),o=r("387e0"),c={computed:{CheckoutCrossEventsInstance:()=>n.registry.use(o.R)},methods:{onCheckoutCrossEvent(t,e){var sub=n.registry.use(o.R).listen(t,t=>{e(t.payload)});return this.checkoutCrossEventsSubscriptions||(this.checkoutCrossEventsSubscriptions=[]),this.checkoutCrossEventsSubscriptions.push(sub),sub},destroyCheckoutCrossEvents(){n.registry.use(o.R).emit(null,null)}},destroyed(){(this.checkoutCrossEventsSubscriptions||[]).forEach(s=>{s.unsubscribe()})}}},"6ab38":(t,e,r)=>{"use strict";var n=r("ce27b"),o=r.n(n);e.Z={name:"OnboardingTooltipMixin",data:()=>({isOnboardingTooltipVisible:!1}),computed:{onboardingTitle(){return o()(this.onboarding,"banner.title","")},onboardingSubTitle(){return o()(this.onboarding,"banner.subtitle","")}},mounted(){if(this.onboarding){var t=o()(this.onboarding,"options.hideTimer",7e3);this.isOnboardingTooltipVisible=!0,this.onboardingTooltipTimeout=setTimeout(()=>{this.closeOnboardingTooltip()},t)}},methods:{closeOnboardingTooltip(){this.onboardingTooltipTimeout&&(clearTimeout(this.onboardingTooltipTimeout),this.isOnboardingTooltipVisible=!1)}}}},"387e0":(t,e,r)=>{"use strict";r.d(e,{H:()=>c,R:()=>f});var n=r("ad965"),o=r("69aed"),c=function(t){return t.MOVE_MAP_TO_GEOLOCATION="moveMapToGeolocation",t.MOVE_MAP_TO_BOUNDS="moveMapToBounds",t.MAP_READY="mapReady",t.CLOSE_TOTAL_MODAL="closeTotalModal",t.STOP_WATCH_MAP_UPDATES="stopWatchMapUpdates",t.DISCOUNT_CODE_CHECKED="discountCodeChecked",t.MAP_CHANGED="mapChanged",t.PAGE_IS_REFRESHING="PAGE_IS_REFRESHING",t}({});class f extends o.EventBus{constructor(...t){super(...t),this._createSubject=()=>new n.ReplaySubject(1)}}f.__serviceName="EventBus_CheckoutCrossEvents"},f25b4:(t,e,r)=>{var n=r("f2ef6");t.exports=function(){if(!arguments.length)return[];var t=arguments[0];return n(t)?t:[t]}},bfae0:(t,e,r)=>{var n=r("b38e1"),o=r("f42a6"),c=r("c7dc9"),f=r("4c2c7"),v=r("71221");function h(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}h.prototype.clear=n,h.prototype.delete=o,h.prototype.get=c,h.prototype.has=f,h.prototype.set=v,t.exports=h},"11fb5":t=>{t.exports=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}},"4eeb3":(t,e,r)=>{var n=r("94195");t.exports=function(t,e){for(var r=t.length;r--;)if(n(t[r][0],e))return r;return-1}},"54d14":t=>{t.exports=function(t,e,r){for(var n=r-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1}},"9123c":(t,e,r)=>{var n=r("0b3ef"),o=r("4b93c");t.exports=function t(e,r,c,f,v){return e===r||(null==e||null==r||!o(e)&&!o(r)?e!=e&&r!=r:n(e,r,c,f,t,v))}},"0b3ef":(t,e,r)=>{var n=r("bfae0"),o=r("d3f34"),c=r("c6521"),f=r("0de17"),v=r("16a26"),h=r("f2ef6"),l=r("72301"),d=r("1ef5e"),m="[object Arguments]",k="[object Array]",M="[object Object]",y=Object.prototype.hasOwnProperty;t.exports=function(object,t,e,r,O,j){var A=h(object),C=h(t),E=A?k:v(object),_=C?k:v(t),w=(E=E==m?M:E)==M,P=(_=_==m?M:_)==M,T=E==_;if(T&&l(object)){if(!l(t))return!1;A=!0,w=!1}if(T&&!w)return j||(j=new n),A||d(object)?o(object,t,e,r,O,j):c(object,t,E,e,r,O,j);if(!(1&e)){var I=w&&y.call(object,"__wrapped__"),S=P&&y.call(t,"__wrapped__");if(I||S){var x=I?object.value():object,R=S?t.value():t;return j||(j=new n),O(x,R,e,r,j)}}return!!T&&(j||(j=new n),f(object,t,e,r,O,j))}},"7ced4":(t,e,r)=>{var n=r("54d14");t.exports=function(t,e){return!!(null==t?0:t.length)&&n(t,e,0)>-1}},d3f34:(t,e,r)=>{var n=r("f25b4"),o=r("11fb5"),c=r("7ced4");t.exports=function(t,e,r,f,v,h){var l=1&r,d=t.length,m=e.length;if(d!=m&&!(l&&m>d))return!1;var k=h.get(t),M=h.get(e);if(k&&M)return k==e&&M==t;var y=-1,O=!0,j=2&r?new n:void 0;for(h.set(t,e),h.set(e,t);++y<d;){var A=t[y],C=e[y];if(f)var E=l?f(C,A,y,e,t,h):f(A,C,y,t,e,h);if(void 0!==E){if(E)continue;O=!1;break}if(j){if(!o(e,function(t,e){if(!c(j,e)&&(A===t||v(A,t,r,f,h)))return j.push(e)})){O=!1;break}}else if(A!==C&&!v(A,C,r,f,h)){O=!1;break}}return h.delete(t),h.delete(e),O}},c6521:t=>{t.exports=function(t,e){return t===e||t!=t&&e!=e}},"0de17":(t,e,r)=>{var n=r("b0071"),o=Object.prototype.hasOwnProperty;t.exports=function(object,t,e,r,c,f){var v=1&e,h=n(object),l=h.length;if(l!=n(t).length&&!v)return!1;for(var d=l;d--;){var m=h[d];if(!(v?m in t:o.call(t,m)))return!1}var k=f.get(object),M=f.get(t);if(k&&M)return k==t&&M==object;var y=!0;f.set(object,t),f.set(t,object);for(var O=v;++d<l;){var j=object[m=h[d]],A=t[m];if(r)var C=v?r(A,j,m,t,object,f):r(j,A,m,object,t,f);if(!(void 0===C?j===A||c(j,A,e,r,f):C)){y=!1;break}O||(O="constructor"==m)}if(y&&!O){var E=object.constructor,_=t.constructor;E==_||!("constructor"in object)||!("constructor"in t)||"function"==typeof E&&E instanceof E&&"function"==typeof _&&_ instanceof _||(y=!1)}return f.delete(object),f.delete(t),y}},b0071:(t,e,r)=>{var n=r("104a0")(Object.keys,Object);t.exports=n},"16a26":t=>{var e=Object.prototype.toString;t.exports=function(t){return e.call(t)}},b38e1:t=>{t.exports=function(){this.__data__=[],this.size=0}},f42a6:(t,e,r)=>{var n=r("4eeb3"),o=Array.prototype.splice;t.exports=function(t){var data=this.__data__,e=n(data,t);return!(e<0)&&(e==data.length-1?data.pop():o.call(data,e,1),--this.size,!0)}},c7dc9:(t,e,r)=>{var n=r("4eeb3");t.exports=function(t){var data=this.__data__,e=n(data,t);return e<0?void 0:data[e][1]}},"4c2c7":(t,e,r)=>{var n=r("4eeb3");t.exports=function(t){return n(this.__data__,t)>-1}},71221:(t,e,r)=>{var n=r("4eeb3");t.exports=function(t,e){var data=this.__data__,r=n(data,t);return r<0?(++this.size,data.push([t,e])):data[r][1]=e,this}},"104a0":t=>{t.exports=function(t,e){return function(r){return t(e(r))}}},94195:t=>{t.exports=function(t,e){return t===e||t!=t&&e!=e}},f2ef6:t=>{var e=Array.isArray;t.exports=e},72301:t=>{t.exports=function(){return!1}},f8a33:(t,e,r)=>{var n=r("9123c");t.exports=function(t,e){return n(t,e)}},"4b93c":t=>{t.exports=function(t){return null!=t&&"object"==typeof t}},"1ef5e":t=>{t.exports=function(){return!1}}}]);