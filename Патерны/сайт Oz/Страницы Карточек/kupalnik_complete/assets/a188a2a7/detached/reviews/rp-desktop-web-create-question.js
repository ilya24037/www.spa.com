"use strict";(self.webpackChunkDetached_reviews=self.webpackChunkDetached_reviews||[]).push([["rp-desktop-web-create-question"],{a0239:(t,e,r)=>{r.a(t,async(t,n)=>{try{var o=r("abb9e"),h=r.n(o),c=r("4a183"),l=t([c]);c=(l.then?(await l)():l)[0];var{CloseIcon:m}=((d={}).CloseIcon={functional:!0,name:"icMCross",meta:{width:24,height:24,viewBox:"0 0 24 24"},render:(t,e)=>t("svg",Object.assign(Object.assign({},e.data),{},{attrs:Object.assign({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24"},e.data.attrs),domProps:{innerHTML:'<path fill="currentColor" d="m12 10.586 6.293-6.295a1 1 0 0 1 1.414 1.414L13.414 12l6.293 6.294a1 1 0 1 1-1.414 1.415L12 13.414 5.707 19.71a1 1 0 0 1-1.414-1.415L10.586 12 4.293 5.706A1 1 0 1 1 5.707 4.29z"/>'}}))},d);e.Z=h().extend({name:"WebCreateQuestionDesktop",components:{CloseIcon:m},mixins:[c.Z]}),n()}catch(t){n(t)}var d})},abcec:(t,e,r)=>{r.d(e,{BE:()=>n,E6:()=>l,MR:()=>h,mi:()=>o,pn:()=>c});var n="200px",o="150px",h="success",c="error",l=function(t){return t.ANON="anon",t.NOT_ANON="not anon",t}({})},"4a183":(t,e,r)=>{r.a(t,async(t,n)=>{try{var o=r("ce27b"),h=r.n(o),c=r("efc03"),l=r.n(c),m=r("b1649"),d=r.n(m),f=r("b204a"),v=r("823b9"),w=r("7ab6c"),y=r("40d6f"),_=r("bcc5e"),x=r("16477"),T=r("2166d"),O=r("b4116"),C=r("abcec"),M=r("225da"),A=t([f,v,w,y,_,O]);[f,v,w,y,_,O]=A.then?(await A)():A;var{AuthorizationServiceMixin:z,DangerIcon:L,SuccessIcon:I}=(t=>{var e,r;(r=e||(e={})).MODAL="modal",r.REDIRECT="redirect";var n={methods:{async redirectToAuth(t){await this.$composerRouter.redirect(t,"_self")},async showAuthForm(t){var{method:r,url:n}=await this._getAuthMethodData(t);r===e.REDIRECT?await this.redirectToAuth(n):this.$registry.useByName("ComposerActions").getModal({url:n,options:{notCentered:!0}})},async _getAuthMethodData(t){var e={name:"authorizationMethod"};t&&(e.query={redirect_uri:t});var{method:r,url:n}=await this.$registry.useByName("ComposerService").actionGet(e);return{method:r,url:n}}}},o={functional:!0,name:"icMDanger",meta:{width:24,height:24,viewBox:"0 0 24 24"},render:(a,t)=>a("svg",Object.assign(Object.assign({},t.data),{},{attrs:Object.assign({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24"},t.data.attrs),domProps:{innerHTML:'<path fill="currentColor" d="M13 21a1 1 0 1 1-2 0 1 1 0 0 1 2 0m-1-10a1 1 0 0 1 1 1v5a1 1 0 1 1-2 0v-5a1 1 0 0 1 1-1"/><path fill="currentColor" d="M12.874 4.505a1 1 0 0 0-1.736-.001L3.136 18.503A1 1 0 0 0 4.004 20h4.004a1 1 0 0 1 0 2H4.004C1.7 22 .257 19.51 1.4 17.51l8.002-14c1.152-2.015 4.057-2.014 5.208.002l7.99 13.999c1.143 2-.301 4.488-2.604 4.488h-3.99a1 1 0 0 1 0-2h3.99a1 1 0 0 0 .869-1.497z"/>'}}))},h={functional:!0,name:"icMConfirmed",meta:{width:24,height:24,viewBox:"0 0 24 24"},render:(t,e)=>t("svg",Object.assign(Object.assign({},e.data),{},{attrs:Object.assign({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24"},e.data.attrs),domProps:{innerHTML:'<path fill="currentColor" d="m11 13.586 4.293-4.293a1 1 0 1 1 1.414 1.414l-5 5a.997.997 0 0 1-1.414 0l-3-3a1 1 0 1 1 1.414-1.414z"/><path fill="currentColor" d="M1 12C1 5.925 5.925 1 12 1s11 4.925 11 11-4.925 11-11 11S1 18.075 1 12m11-9a9 9 0 1 0 0 18 9 9 0 0 0 0-18"/>'}}))};return t.AuthorizationServiceMixin=n,t.DangerIcon=o,t.SuccessIcon=h,t})({});e.Z={provide(){return{getLocalization:()=>this.lmtParams}},mixins:[f.validationMixin,z],components:{OzField:v.OzField,OzTextarea:w.OzTextarea,OzNotification:y.OzNotification,OzTransition:_.OzTransition,FormInfo:O.Z,TextareaLength:T.Z},validations(){return{modelForm:{content:{minLength:t=>d()(t).length&&d()(t).length>=this.lmtParams.fieldMinLength}}}},data(){return{TEXTAREA_MAX_HEIGHT:C.BE,TEXTAREA_MAX_HEIGHT_MOBILE:C.mi,SuccessIcon:I,DangerIcon:L,isCollapsed:!1,loading:!1,serverError:null,modelForm:{content:"",isAnonymous:!1},touchMap:{},firstSendAnalytics:!0,visibilitySettings:{once:!0,callback:this.onViewWidget},SUCCESS:C.MR}},computed:{hasStateError(){return!this.widgetState||this.widgetState.error||!Object.keys(this.widgetState).length},showStateError(){return!this.asyncType&&this.hasStateError||this.hasStateError&&this.asyncType&&this.isAsyncLoaded},lmtParams(){return h()(this.widgetState,"lmtParams",{})},formState(){return this.widgetState.formState||""},rulesRs(){if(!l()(this.widgetState.rules))return this.widgetState.rules.map(t=>{if(t.content)return Object.assign(Object.assign({},t),{},{content:t.content.replace("%rulesText%",this.lmtParams.rulesText).replace("%rulesLinkText%",this.lmtParams.rulesLinkText),href:t.href?t.href.replace("%rulesLink%",this.rulesLink):null})})},iconName(){switch(this.formState){case C.pn:return L;case C.MR:return I;default:return L}},notificationText(){return this.serverError?this.lmtParams.serverErrorText:this.formState===C.MR?this.lmtParams.successText:void 0},fieldLengthErrorCustom(){return this.lmtParams.fieldLengthError.replace("%fieldMinLength%",this.lmtParams.fieldMinLength).replace("%fieldMaxLength%",this.lmtParams.fieldMaxLength)},errors(){return this.$v.modelForm.content.$dirty&&this.isCollapsed?[!this.$v.modelForm.content.minLength&&this.fieldLengthErrorCustom].filter(Boolean):[]},classesNotification(){return[this.$style.notification,this.$style[this.formState]]}},methods:{async openFormInfo(){this.firstSendAnalytics&&(this.sendTokenAnalytics(x.EActionTypes.CLICK_ACTION),this.firstSendAnalytics=!1),this.widgetState.isLoggedIn?this.isCollapsed=!0:await this.showAuthForm()},onChangeAnonymous(t){this.modelForm.isAnonymous=t},delayTouch(t,e){t.$reset(),this.touchMap[e]&&clearTimeout(this.touchMap[e]),this.touchMap[e]=setTimeout(t.$touch,1e3)},resetTouch(t){this.touchMap[t]&&clearTimeout(this.touchMap[t])},resetForm(){this.$v.modelForm.$reset(),this.modelForm={content:"",isAnonymous:!1}},closeFormInfo(){this.isCollapsed=!1,this.serverError=null,this.$v.modelForm.$reset()},async onSubmit(){if(!this.loading)if(this.$v.modelForm.content.$invalid)this.delayTouch(this.$v.modelForm.content,"content");else{this.loading=!0,this.serverError=null,this.resetTouch("content");try{var t=this.widgetState.action||"",e={status:this.modelForm.isAnonymous?C.E6.ANON:C.E6.NOT_ANON};await this.fetchAsyncState({action:t,actionBody:this.modelForm}),this.formState===C.MR&&(this.sendTokenAnalytics(x.EActionTypes.ADD_ACTION,e),this.resetForm(),this.isCollapsed=!1),this.formState===C.pn&&(this.serverError=!0)}catch(t){this.serverError=!0}this.loading=!1}},asyncWidgetMapper(t){return Object.assign(this.widgetState,t)},onViewWidget(){this.sendTokenAnalytics(x.EActionTypes.VIEW_ACTION)},sendTokenAnalytics:M.A}},n()}catch(t){n(t)}})},"268f6":(t,e,r)=>{r.a(t,async(t,n)=>{try{r.r(e);var o=r("3def1"),h=r("af4fa"),c=r("b671c"),l=r("695d8"),m=r.n(l),d=t([h]);function f(t){this.$style=c.Z.locals||c.Z}h=(d.then?(await d)():d)[0];var component=m()(h.Z,o.s,o.x,!1,f,null,null);e.default=component.exports,n()}catch(v){n(v)}})},f0ef5:(t,e,r)=>{r.d(e,{Z:()=>n});var n={control:"ny4_30",block:"n4y_30",row:"yn4_30"}},e9696:(t,e,r)=>{r.d(e,{Z:()=>n});var n={name:"y4n_30",block:"ny5_30",row:"n5y_30"}},"2e21a":(t,e,r)=>{r.d(e,{Z:()=>n});var n={info:"p8q_30",rules:"qp8_30",toggle:"q8p_30",toggleCustom:"pq9_30",wrapper:"p9q_30",mobile:"qp9_30",button:"q9p_30"}},e527e:(t,e,r)=>{r.d(e,{Z:()=>n});var n={textareaLength:"pr_30",error:"rp_30"}},b671c:(t,e,r)=>{r.d(e,{Z:()=>n});var n={form:"pr0_30",closeIcon:"p0r_30",title:"rp0_30",subtitle:"r0p_30",textareaWrapper:"pr1_30",notification:"p1r_30",success:"rp1_30",error:"r1p_30",default:"pr2_30"}},af4fa:(t,e,r)=>{r.a(t,async(t,n)=>{try{var o=r("a0239"),h=t([o]);o=(h.then?(await h)():h)[0],e.Z=o.Z,n()}catch(t){n(t)}})},"3def1":(t,e,r)=>{r.d(e,{s:()=>n,x:()=>o});var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{directives:[{name:"detect-viewport",rawName:"v-detect-viewport",value:t.visibilitySettings,expression:"visibilitySettings"}]},[t.showStateError?t._e():[r("form",{class:t.$style.form,attrs:{novalidate:""},on:{submit:function(e){return e.preventDefault(),t.onSubmit.apply(null,arguments)}}},[t.isCollapsed?r("CloseIcon",{class:t.$style.closeIcon,on:{click:t.closeFormInfo}}):t._e(),t._v(" "),r("div",{class:t.$style.title},[t._v(t._s(t.lmtParams.title))]),t._v(" "),r("div",{class:t.$style.subtitle},[t._v(t._s(t.lmtParams.subTitle))]),t._v(" "),r("div",{class:t.$style.textareaWrapper,on:{click:t.openFormInfo}},[r("OzField",{attrs:{errors:t.errors}},[r("OzTextarea",{attrs:{size:"m",placeholder:t.lmtParams.fieldPlaceholder,"max-length":String(t.lmtParams.fieldMaxLength),"max-height":t.TEXTAREA_MAX_HEIGHT,"auto-height-by-rows":!0,"has-error":!!t.errors.length,"test-info":{automatizationId:"create-question-textarea"}},on:{input:function(e){return t.delayTouch(t.$v.modelForm.content,"content")}},model:{value:t.$v.modelForm.content.$model,callback:function(e){t.$set(t.$v.modelForm.content,"$model",e)},expression:"$v.modelForm.content.$model"}})],1),t._v(" "),r("OzTransition",[t.isCollapsed?r("TextareaLength",{attrs:{"field-max-length":t.lmtParams.fieldMaxLength,"text-length":t.$v.modelForm.content.$model.length,error:!!t.errors.length}}):t._e()],1)],1),t._v(" "),r("OzTransition",[t.isCollapsed&&t.widgetState.isLoggedIn?r("FormInfo",{attrs:{"user-name":t.widgetState.user,"is-anonymous":t.modelForm.isAnonymous,"create-as-label":t.lmtParams.createAsLabel,"anonymous-toggle-label":t.lmtParams.anonymousToggleLabel,"send-button-text":t.lmtParams.sendButtonText,loading:t.loading,"rules-rs":t.rulesRs},on:{changeAnonymous:t.onChangeAnonymous}}):t._e()],1)],1),t._v(" "),t.notificationText?r("OzNotification",{class:t.classesNotification,attrs:{theme:"light",icon:t.iconName,"test-info":t.formState===t.SUCCESS?{automatizationId:"create-question-success-text"}:{}}},[t._v("\n      "+t._s(t.notificationText)+"\n    ")]):t._e()]],2)},o=[]}}]);