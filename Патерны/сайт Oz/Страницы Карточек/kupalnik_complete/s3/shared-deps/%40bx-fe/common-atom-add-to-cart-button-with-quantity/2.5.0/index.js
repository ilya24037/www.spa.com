(()=>{var t={181:(t,e,n)=>{"use strict";n.d(e,{Z:()=>g});var i=window.__federation__.deps["@bx-fe/tracker-types"]||{},s=window.__federation__.deps["@bx-fe/ui-kit-css-vars@5.3.2"]||{},o=window.__federation__.deps["@bx-fe/ui-kit-ds-icon-button@5.3.2"]||{},a=window.__federation__.deps["@bx-fe/ui-kit-ds-button@5.3.2"]||{},r=window.__federation__.deps["@bx-fe/common-atom-button@2.5.0"]||{},c=window.__federation__.deps["@bx-fe/common-feature-cart@1.3.2"]||{},l={functional:!0,name:"icMPlus",meta:{width:24,height:24,viewBox:"0 0 24 24"},render:(t,e)=>t("svg",Object.assign(Object.assign({},e.data),{},{attrs:Object.assign({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24"},e.data.attrs),domProps:{innerHTML:'<path fill="currentColor" d="M12 4a1 1 0 0 0-1 1v6H5a1 1 0 1 0 0 2h6v6a1 1 0 1 0 2 0v-6h6a1 1 0 1 0 0-2h-6V5a1 1 0 0 0-1-1"/>'}}))},u={functional:!0,name:"icMMinus",meta:{width:24,height:24,viewBox:"0 0 24 24"},render:(t,e)=>t("svg",Object.assign(Object.assign({},e.data),{},{attrs:Object.assign({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24"},e.data.attrs),domProps:{innerHTML:'<path fill="currentColor" d="M5 11a1 1 0 1 0 0 2h14a1 1 0 1 0 0-2z"/>'}}))},d=(t,e)=>Math.floor(t/e)*e,h=(t,e)=>Math.ceil(t/e)*e,m={STYLE_TYPE_PRIMARY:{theme:"actionPrimary"},STYLE_TYPE_SECONDARY:{theme:"actionSecondary"},STYLE_TYPE_PRIMARY_EXPRESS:{theme:"accentPrimary"},STYLE_TYPE_PRIMARY_FRESH:{theme:"custom",backgroundColor:"bgFreshPrimary",textColor:"textLightKey",iconColor:"graphicPrimaryOnDark"}},I={S:"400",M:"400",L:"500"},_="UPDATE_MODE_MIN_ITEMS",b="UPDATE_MODE_STEP",y="UPDATE_MODE_QUANT",p={SIZE_MODE_FILL:"SIZE_MODE_FILL",SIZE_MODE_FIT:"SIZE_MODE_FIT",SIZE_MODE_140:"SIZE_MODE_140"},f={name:"AtomAddToCartButtonWithQuantity",components:{DsButton:a.DsButton,DsIconButton:o.DsIconButton},mixins:[r.ButtonAtomMixin,c.AddToCartWithModalMixin,c.CartGlobalStoreMixin],inject:{isMobile:{default:!1},asyncIconComponent:{default:()=>()=>{}}},props:Object.assign(Object.assign({},r.ButtonAtomMixin.props),{},{text:{type:String,required:!0,default:""},currentItems:{type:Number,default:0},maxItems:{type:Number,default:0},size:{type:String,default:"M"},theme:{type:String,default:"STYLE_TYPE_PRIMARY"},mode:{type:String,default:_},webAction:{type:Object,default:null},buttonIconId:{type:String,default:""},sellerIcon:{type:Object,default:()=>({sellerIconId:"",sellerIconBgColor:"",tintColor:"#f91155"})},buttonSizeMode:{type:String,default:p.SIZE_MODE_FIT,validator:t=>Object.values(p).includes(t)},qtyTextDisabled:{type:Boolean,default:!1},extend:{type:String,default:""}}),data(){return{processing:!1,localCurrentItems:this.currentItems,isDisabled:!1}},computed:{hasIcon(){return this.newButton&&this.roundIcon},getButtonColorClass(){return this.$style[this.getThemeParams.theme]},newButton(){return this.buttonSizeMode!==p.SIZE_MODE_FIT},isButtonFixed(){return this.buttonSizeMode===p.SIZE_MODE_140},mainButtonIcon(){if(this.buttonIconId)return this.asyncIconComponent(this.buttonIconId)},roundIcon(){if(this.sellerIcon.sellerIconId)return this.asyncIconComponent(this.sellerIcon.sellerIconId)},roundIconBgColor(){if(this.sellerIcon.sellerIconBgColor)return(0,s.getColorByNameOrHex)(this.sellerIcon.sellerIconBgColor)},roundIconColor(){if(this.sellerIcon.tintColor)return(0,s.getColorByNameOrHex)(this.sellerIcon.tintColor)},iconComponents:()=>({Plus:l,Minus:u}),getThemeParams(){return m[this.theme]},buttonSize(){return I[this.size]},localItemsQuantity(){return this.newButton&&this.qtyTextDisabled?this.localCurrentItems:this.$i18n.t("system@items_quantity",{substitutions:{quantity:this.localCurrentItems}})}},watch:{itemsHash:{handler(t){var e,n=null==(e=this.action)?void 0:e.id;this.setLocalCurrentItems(t[n])}}},mounted(){var t,e=null==(t=this.action)?void 0:t.id;this.setLocalCurrentItems(this.itemsHash[e])},methods:{async addToCart(){this.processing=!0;var{id:t,quantity:e,selectedDeliverySchema:n}=this.action,i=this.mode===y?1:e,{success:s,cartItems:o}=await this.addToCartWithAction(t,i,n,this.webAction,{enum:this.extend});if(s){var a=o[t];this.setLocalCurrentItems(a),this.sendCartAdd(a.selectedDeliverySchema)}this.processing=!1},async removeFromCart(){this.processing=!0;var{id:t,selectedDeliverySchema:e}=this.action,{success:n}=await this.addToCartWithAction(t,0,e,this.webAction,{enum:this.extend});n&&(this.sendCartRemove(),this.setLocalCurrentItems()),this.processing=!1},setLocalCurrentItems(t){var e,n=null==(e=this.action)?void 0:e.selectedDeliverySchema;if(!t)return this.isDisabled=!1,void(this.localCurrentItems=0);t.selectedDeliverySchema===n?(this.isDisabled=!1,this.localCurrentItems=t.quantity):(this.isDisabled=!0,this.localCurrentItems=0)},async changeQuantity(t){var e,{id:n,selectedDeliverySchema:s,quantity:o}=this.action;if(this.mode===_&&(e=this.localCurrentItems+t),this.mode===b&&(e=this.localCurrentItems+t*o),this.mode===y){var a=o>this.localCurrentItems?this.localCurrentItems+t:((t,e,n)=>e===n&&t<0?e+t:e%n?t<0?d(e,n):h(e,n):t<0?e-n:e+n)(t,this.localCurrentItems,o);if(e=Math.min(a,this.maxItems),t<0&&this.localCurrentItems<2)return this.removeFromCart()}if(t<0&&e<o&&this.mode!==y)return this.removeFromCart();var r=Math.abs(this.localCurrentItems-e);this.processing=!0;var{success:c,cartItems:l}=await this.addToCartWithAction(n,e,s,this.webAction,{enum:this.extend});if(c){var u=l[n];this.setLocalCurrentItems(u);var m=this.trackingInfo&&this.trackingInfo.click||{},I={quantity:r,totalQuantity:this.localCurrentItems};u.selectedDeliverySchema&&(I.selectedDeliverySchema=u.selectedDeliverySchema),this.$emit("changeQuantity",{val:t,quantity:r,totalQuantity:this.localCurrentItems,custom:I,trackingInfo:{click:Object.assign(Object.assign({},m),{},{actionType:t>0?i.EActionTypes.INCREMENT_ACTION:i.EActionTypes.DECREMENT_ACTION})}})}this.processing=!1},sendCartAdd(t){var e=this.trackingInfo&&this.trackingInfo.click||{},n={quantity:this.localCurrentItems,totalQuantity:this.localCurrentItems};t&&(n.selectedDeliverySchema=t),this.$emit("addToCart",{quantity:this.localCurrentItems,totalQuantity:this.localCurrentItems,custom:n,trackingInfo:{click:Object.assign(Object.assign({},e),{},{actionType:i.EActionTypes.TO_CART_ACTION})}})},sendCartRemove(){var{selectedDeliverySchema:t}=this.action,e=this.trackingInfo&&this.trackingInfo.click||{},n={quantity:this.localCurrentItems,totalQuantity:this.localCurrentItems};t&&(n.selectedDeliverySchema=t),this.$emit("removeFromCart",{custom:n,trackingInfo:{click:Object.assign(Object.assign({},e),{},{actionType:i.EActionTypes.REMOVE_ACTION})}})}}},C={roundIcon:"p0b2_5_0-a",actionPrimary:"p0b2_5_0-a0",actionSecondary:"p0b2_5_0-a1",accentPrimary:"p0b2_5_0-a2",custom:"p0b2_5_0-a3",additionalPaddings:"p0b2_5_0-a4",container:"p0b2_5_0-a5",active:"p0b2_5_0-a6",fill:"p0b2_5_0-a7",desktop:"p0b2_5_0-a8",fixedWidth:"p0b2_5_0-a9",count:"p0b2_5_0-b","size-M":"p0b2_5_0-b0","count-button-wrap":"p0b2_5_0-b1","size-S":"p0b2_5_0-b2"},v=window.__federation__.deps["vue-loader-runtime"].componentNormalizer;var g=n.n(v)()(f,(function(){var t,e,n=this,i=n.$createElement,s=n._self._c||i;return n.localCurrentItems<1?s("div",{class:[n.$style.container,(t={},t[n.$style.desktop]=!n.isMobile&&!n.newButton,t[n.$style.fill]=n.newButton,t[n.$style.fixedWidth]=n.isButtonFixed,t[n.$style.isMobile]=n.isMobile,t)]},[s("DsButton",n._b({directives:[{name:"qa",rawName:"v-qa:id",value:n.testInfo.automatizationId||"tile-buy-button",expression:"testInfo.automatizationId || 'tile-buy-button'",arg:"id"}],class:n.hasIcon&&n.$style.additionalPaddings,attrs:{size:n.buttonSize,title:n.text,icon:n.newButton&&n.mainButtonIcon,"icon-name":n.buttonIconId,fill:n.newButton,disabled:n.isDisabled,"no-min-width":n.isMobile},on:{click:n.addToCart}},"DsButton",n.getThemeParams,!1)),n._v(" "),n.newButton&&!n.isDisabled&&n.roundIcon?s("span",{class:n.$style.roundIcon,style:{backgroundColor:n.roundIconBgColor}},[s(n.roundIcon,{tag:"component",class:n.getButtonColorClass,style:{color:n.roundIconColor}})],1):n._e()],1):s("div",{class:[n.$style.container,n.$style.active,n.$style["size-"+n.size],(e={},e[n.$style.desktop]=!n.isMobile&&!n.newButton,e[n.$style.fill]=n.newButton,e[n.$style.fixedWidth]=n.isButtonFixed,e)]},[s("div",{class:!n.newButton&&n.$style["count-button-wrap"]},[s("DsIconButton",{directives:[{name:"qa",rawName:"v-qa:id",value:"button-minus",expression:"'button-minus'",arg:"id"}],attrs:{icon:n.iconComponents.Minus,size:n.buttonSize,theme:"actionSecondary",fill:!n.newButton},on:{click:function(t){return n.changeQuantity(-1)}}})],1),n._v(" "),s("span",{class:n.$style.count},[n._v(n._s(n.localItemsQuantity))]),n._v(" "),s("div",{class:!n.newButton&&n.$style["count-button-wrap"]},[s("DsIconButton",{directives:[{name:"qa",rawName:"v-qa:id",value:"button-plus",expression:"'button-plus'",arg:"id"}],attrs:{disabled:n.localCurrentItems+(n.action.quantity||1)>n.maxItems,icon:n.iconComponents.Plus,theme:"actionSecondary",size:n.buttonSize,fill:!n.newButton},on:{click:function(t){return n.changeQuantity(1)}}})],1)])}),[],!1,(function(t){this.$style=C.locals||C}),null,null).exports}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var i,s={};i=s,Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"default",{get:()=>n(181).Z}),window.__federation__.deps["@bx-fe/common-atom-add-to-cart-button-with-quantity@2.5.0"]||(window.__federation__.deps["@bx-fe/common-atom-add-to-cart-button-with-quantity@2.5.0"]=Object.defineProperties({},Object.getOwnPropertyDescriptors(s)))})();