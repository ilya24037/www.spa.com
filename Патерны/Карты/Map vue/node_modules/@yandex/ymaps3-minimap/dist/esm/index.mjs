var t,s={d:(t,o)=>{for(var i in o)s.o(o,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:o[i]})},o:(t,s)=>Object.prototype.hasOwnProperty.call(t,s)},o={};function i(t){const[[s,o],[i,e]]=t;return{type:"Polygon",coordinates:[[[s,o],[i,o],[i,e],[s,e],[s,o]]]}}s.d(o,{a:()=>a});const e=Object.freeze({size:[128,90],zoomOffset:5,showBounds:!0,collapsed:!1,showCollapsedControl:!0,controllable:!0,boundsDrawingStyle:{stroke:[{color:"#cccccc",width:1,opacity:1}],fill:"#ffffff",fillOpacity:.1}});class a extends ymaps3.YMapGroupEntity{constructor(t){super(t),this._minimapUpdating=!1,this._mapUpdating=!1,this._container=document.createElement("div"),this._container.classList.add("ymaps3--minimap"),this._container.style.width="64px",this._container.style.height="64px",this._minimap=new ymaps3.YMap(this._container,{showScaleInCopyrights:!1,location:{center:[0,0],zoom:1},zoomRange:t.zoomRange}),this._minimap.addChild(new ymaps3.YMapDefaultSchemeLayer({})),this._minimap.addChild(new ymaps3.YMapDefaultFeaturesLayer({}))}_setLocation(){this._props.location?this._minimap.setLocation(this._props.location):this._minimap.setLocation({zoom:this.root.zoom-this._props.zoomOffset,center:this.root.center})}_setCamera(){const t=this._props.camera||{tilt:this.root.tilt,azimuth:this.root.azimuth};this._minimap.setCamera(t)}_setSize(){this._props.collapsed?(this._container.style.width="64px",this._container.style.height="64px"):(this._container.style.width=`${this._props.size[0]}px`,this._container.style.height=`${this._props.size[1]}px`)}_onMapUpdate(){this._minimapUpdating||(this._mapUpdating=!0,this._setLocation(),this._updateBoundsFeature(),this._mapUpdating=!1)}_createCollapseButton(){const t=document.createElement("button");return t.type="button",t.classList.add("ymaps3--minimap-button"),t.classList.toggle("ymaps3--minimap-button_collapsed",this._props.collapsed),t.onclick=()=>this._props.onCollapsedChange(this._props.collapsed),t}_updateCollapseButton(){this._button.classList.toggle("ymaps3--minimap-button_collapsed",this._props.collapsed),this._button.onclick=()=>this._props.onCollapsedChange(this._props.collapsed)}_createCollapsedControl(){return new ymaps3.YMapControls({position:"top right"},[new ymaps3.YMapControl({transparent:!0},this._button)])}_updateCollapsedControl(t){this._controls&&(this._props.collapsed?this._controls.update({position:"bottom left"}):this._controls.update({position:"top right"})),t.showCollapsedControl&&!this._props.showCollapsedControl?this._minimap.removeChild(this._controls):!t.showCollapsedControl&&this._props.showCollapsedControl&&this._minimap.addChild(this._controls)}_createBoundsFeature(){const t=i(this.root.bounds),s=new ymaps3.YMapFeature({geometry:t,style:this._props.boundsDrawingStyle});return this._props.showBounds&&this._minimap.addChild(s),s}_updateBoundsFeature(t){if(this._boundsFeature){const t=i(this.root.bounds);this._boundsFeature.update({geometry:t,style:this._props.boundsDrawingStyle})}(null==t?void 0:t.showBounds)?this._minimap.removeChild(this._boundsFeature):t&&!t.showBounds&&this._props.showBounds&&this._minimap.addChild(this._boundsFeature)}_createMinimapListener(){return new ymaps3.YMapListener({onUpdate:t=>{if(!this._mapUpdating){this._minimapUpdating=!0;const s=t.location.zoom+this._props.zoomOffset;this.root.setLocation({center:t.location.center,zoom:s}),this._updateBoundsFeature(),this._minimapUpdating=!1}}})}_updateMinimapListener(t){this._minimapListener&&(t.controllable&&!this._props.controllable?this._minimap.removeChild(this._minimapListener):!t.controllable&&this._props.controllable&&this._minimap.addChild(this._minimapListener))}_onAttach(){this._setLocation(),this._setSize(),this._setCamera(),this._boundsFeature=this._createBoundsFeature(),this._props.showBounds&&this._minimap.addChild(this._boundsFeature),this._button=this._createCollapseButton(),this._controls=this._createCollapsedControl(),this._props.showCollapsedControl&&this._minimap.addChild(this._controls),this._minimapListener=this._createMinimapListener(),this._props.controllable&&this._minimap.addChild(this._minimapListener),this._mapListener=new ymaps3.YMapListener({onUpdate:()=>this._onMapUpdate(),onResize:()=>this._onMapUpdate()}),this.addChild(this._mapListener),this._detachDom=ymaps3.useDomContext(this,this._container,null)}_onUpdate(t,s){this._setLocation(),this._setSize(),this._setCamera(),this._updateBoundsFeature(s),this._updateCollapseButton(),this._updateCollapsedControl(s),this._updateMinimapListener(s)}_onDetach(){var t;null===(t=this._detachDom)||void 0===t||t.call(this),this._detachDom=null,this._minimap=null,this._boundsFeature=null,this._button=null,this._controls=null,this._container=null,this._minimapListener=null}}t=ymaps3.optionsKeyVuefy,a[t]={props:["size","zoomOffset","showBounds","collapsed","showCollapsedControl","controllable","boundsDrawingStyle","onCollapsedChange"]},a.defaultProps=e;var n=o.a;export{n as YMapMiniMap};