# üéØ Clusterer - –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–∫ –¥–ª—è Yandex Maps

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–ú–æ–¥—É–ª—å `Clusterer` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –º–µ—Ç–æ–∫ –¥–ª—è –∫–∞—Ä—Ç –Ø–Ω–¥–µ–∫—Å. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –±–ª–∏–∑–∫–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –≤ –∫–ª–∞—Å—Ç–µ—Ä—ã –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —É–¥–æ–±—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üéØ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞** - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –±–ª–∏–∑–∫–∏—Ö –º–µ—Ç–æ–∫ –≤ –∫–ª–∞—Å—Ç–µ—Ä—ã
- üìä **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Ç—ã—Å—è—á–∞–º–∏ –º–µ—Ç–æ–∫
- üé® **16+ preset —Å—Ç–∏–ª–µ–π** - –≥–æ—Ç–æ–≤—ã–µ —Ü–≤–µ—Ç–æ–≤—ã–µ —Å—Ö–µ–º—ã –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- ‚öôÔ∏è **–ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** - —Ä–∞–∑–º–µ—Ä —Å–µ—Ç–∫–∏, –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∫–ª–∞—Å—Ç–µ—Ä–∞
- üì± **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –º–∞—Å—à—Ç–∞–±–∞
- üéà **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Balloon** - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ –æ–∫–Ω–∞ –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- üí¨ **–•–∏–Ω—Ç—ã** - –ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
- üéÆ **–ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–∞–∫–µ—Ç–æ–≤
- üí° **TypeScript** - –ø–æ–ª–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è
- üéÆ **Vue 3** - –≥–æ—Ç–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å Composition API

## üì¶ –°–æ—Å—Ç–∞–≤ –º–æ–¥—É–ª—è

```
Clusterer/
‚îú‚îÄ‚îÄ Clusterer.js       # –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å (816 —Å—Ç—Ä–æ–∫)
‚îú‚îÄ‚îÄ Clusterer.d.ts     # TypeScript –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
‚îú‚îÄ‚îÄ Clusterer.vue      # Vue 3 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (483 —Å—Ç—Ä–æ–∫–∏)
‚îî‚îÄ‚îÄ README.md          # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### Vanilla JavaScript

```javascript
import YMapsCore from '../../core/YMapsCore.js'
import Clusterer from './Clusterer.js'
import Placemark from '../Placemark/Placemark.js'

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã
const mapsCore = new YMapsCore({ apiKey: 'your-key' })
const map = await mapsCore.createMap('map-container', {
  center: [55.753994, 37.622093],
  zoom: 10
})

// –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ç–æ—Ä–∞
const clusterer = new Clusterer(map, {
  preset: 'islands#blueClusterIcons',
  gridSize: 60,
  minClusterSize: 2
})

// –°–æ–∑–¥–∞–Ω–∏–µ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–æ–∫
const placemarks = []
for (let i = 0; i < 100; i++) {
  const placemark = new Placemark(
    [55.75 + Math.random() * 0.1, 37.62 + Math.random() * 0.1],
    { 
      balloonContent: `–ú–µ—Ç–∫–∞ ${i + 1}`,
      hintContent: `–ü–æ–¥—Å–∫–∞–∑–∫–∞ ${i + 1}`
    }
  )
  placemarks.push(placemark)
}

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ç–æ–∫ –≤ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ç–æ—Ä
await clusterer.add(placemarks)
```

### Vue 3

```vue
<template>
  <div class="map-container">
    <div id="map" style="height: 500px"></div>
    
    <YMapsClusterer
      :map="mapInstance"
      :placemarks="markers"
      preset="islands#redClusterIcons"
      :grid-size="80"
      :min-cluster-size="3"
      :auto-fit="true"
      @cluster-click="onClusterClick"
      @placemarks-change="onPlacemarksChange"
    />
    
    <div class="controls">
      <button @click="addRandomMarkers">
        –î–æ–±–∞–≤–∏—Ç—å 50 –º–µ—Ç–æ–∫
      </button>
      <button @click="clearAll">
        –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ
      </button>
      <p>–í—Å–µ–≥–æ –º–µ—Ç–æ–∫: {{ totalMarkers }}</p>
    </div>
  </div>
</template>

<script setup>
import { ref, reactive, onMounted } from 'vue'
import YMapsCore from '@/ymaps-components/core/YMapsCore'
import YMapsClusterer from '@/ymaps-components/modules/Clusterer/Clusterer.vue'
import Placemark from '@/ymaps-components/modules/Placemark/Placemark'

const mapInstance = ref(null)
const markers = ref([])
const totalMarkers = ref(0)

onMounted(async () => {
  const mapsCore = new YMapsCore({ apiKey: 'your-key' })
  mapInstance.value = await mapsCore.createMap('map', {
    center: [55.753994, 37.622093],
    zoom: 10
  })
  
  // –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –º–µ—Ç–∫–∏
  addRandomMarkers()
})

const addRandomMarkers = () => {
  const newMarkers = []
  
  for (let i = 0; i < 50; i++) {
    const marker = new Placemark(
      [55.75 + Math.random() * 0.2, 37.62 + Math.random() * 0.2],
      { 
        balloonContent: `–ú–µ—Ç–∫–∞ ${markers.value.length + i + 1}` 
      }
    )
    newMarkers.push(marker)
  }
  
  markers.value = [...markers.value, ...newMarkers]
}

const clearAll = () => {
  markers.value = []
}

const onClusterClick = (cluster, event) => {
  console.log('–ö–ª–∏–∫ –ø–æ –∫–ª–∞—Å—Ç–µ—Ä—É:', cluster)
}

const onPlacemarksChange = (count) => {
  totalMarkers.value = count
}
</script>
```

## üìñ API Reference

### –ö–ª–∞—Å—Å Clusterer

#### –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä

```javascript
new Clusterer(map, options)
```

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|----------|
| `map` | Object | –≠–∫–∑–µ–º–ø–ª—è—Ä –∫–∞—Ä—Ç—ã Yandex Maps |
| `options` | Object | –û–ø—Ü–∏–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ç–æ—Ä–∞ |

#### –ú–µ—Ç–æ–¥—ã

##### add(placemark)
–î–æ–±–∞–≤–ª—è–µ—Ç –º–µ—Ç–∫—É –∏–ª–∏ –º–∞—Å—Å–∏–≤ –º–µ—Ç–æ–∫ –≤ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ç–æ—Ä.

```javascript
// –û–¥–Ω–∞ –º–µ—Ç–∫–∞
await clusterer.add(placemark)

// –ú–∞—Å—Å–∏–≤ –º–µ—Ç–æ–∫
await clusterer.add([placemark1, placemark2, placemark3])
```

##### remove(placemark)
–£–¥–∞–ª—è–µ—Ç –º–µ—Ç–∫—É –∏–ª–∏ –º–∞—Å—Å–∏–≤ –º–µ—Ç–æ–∫ –∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ç–æ—Ä–∞.

```javascript
await clusterer.remove(placemark)
```

##### removeAll()
–£–¥–∞–ª—è–µ—Ç –≤—Å–µ –º–µ—Ç–∫–∏ –∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ç–æ—Ä–∞.

```javascript
await clusterer.removeAll()
```

##### fitToViewport(options)
–¶–µ–Ω—Ç—Ä–∏—Ä—É–µ—Ç –∫–∞—Ä—Ç—É –ø–æ –≤—Å–µ–º –º–µ—Ç–∫–∞–º.

```javascript
await clusterer.fitToViewport({
  checkZoomRange: true,
  zoomMargin: 50
})
```

##### refresh()
–ü–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∫–ª–∞—Å—Ç–µ—Ä—ã.

```javascript
clusterer.refresh()
```

##### setGridSize(size)
–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä —Å–µ—Ç–∫–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏.

```javascript
clusterer.setGridSize(100) // —Ä–∞–∑–º–µ—Ä –≤ –ø–∏–∫—Å–µ–ª—è—Ö
```

##### setMinClusterSize(size)
–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Ç–æ–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–∞.

```javascript
clusterer.setMinClusterSize(3)
```

### Vue –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

#### Props

| Prop | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|--------------|----------|
| `map` | Object | **required** | –≠–∫–∑–µ–º–ø–ª—è—Ä –∫–∞—Ä—Ç—ã |
| `placemarks` | Array | [] | –ú–∞—Å—Å–∏–≤ –º–µ—Ç–æ–∫ |
| `preset` | String | 'islands#blueClusterIcons' | Preset —Å—Ç–∏–ª—å |
| `gridSize` | Number | 60 | –†–∞–∑–º–µ—Ä —Å–µ—Ç–∫–∏ (10-300) |
| `minClusterSize` | Number | 2 | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä (2-100) |
| `maxZoom` | Number | 16 | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∑—É–º |
| `zoomMargin` | Number | 2 | –û—Ç—Å—Ç—É–ø –ø—Ä–∏ –∑—É–º–µ |
| `hasBalloon` | Boolean | true | –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å balloon |
| `hasHint` | Boolean | true | –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ö–∏–Ω—Ç—ã |
| `disableClickZoom` | Boolean | false | –û—Ç–∫–ª—é—á–∏—Ç—å –∑—É–º –ø–æ –∫–ª–∏–∫—É |
| `autoFit` | Boolean | false | –ê–≤—Ç–æ—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ |
| `autoFitDelay` | Number | 100 | –ó–∞–¥–µ—Ä–∂–∫–∞ –∞–≤—Ç–æ—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è |

#### –°–æ–±—ã—Ç–∏—è

| –°–æ–±—ã—Ç–∏–µ | Payload | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|---------|----------|
| `ready` | Clusterer | –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ç–æ—Ä –≥–æ—Ç–æ–≤ |
| `clusterAdd` | Cluster | –î–æ–±–∞–≤–ª–µ–Ω –∫–ª–∞—Å—Ç–µ—Ä |
| `clusterRemove` | Cluster | –£–¥–∞–ª–µ–Ω –∫–ª–∞—Å—Ç–µ—Ä |
| `clusterClick` | Cluster, Event | –ö–ª–∏–∫ –ø–æ –∫–ª–∞—Å—Ç–µ—Ä—É |
| `placemarksChange` | Number | –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–µ—Ç–æ–∫ |
| `boundsChange` | Bounds | –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü |
| `error` | Error | –û—à–∏–±–∫–∞ |

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è

```javascript
const clusterer = new Clusterer(map)

// –î–æ–±–∞–≤–ª—è–µ–º –º–Ω–æ–≥–æ –º–µ—Ç–æ–∫
for (let i = 0; i < 500; i++) {
  const lat = 55.75 + (Math.random() - 0.5) * 0.5
  const lng = 37.62 + (Math.random() - 0.5) * 0.5
  
  const placemark = new Placemark([lat, lng], {
    balloonContent: `–¢–æ—á–∫–∞ ${i + 1}`
  })
  
  await clusterer.add(placemark)
}
```

### –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å—Ç–∏–ª–∏ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤

```javascript
import { CLUSTER_PRESETS } from './Clusterer.js'

const clusterer = new Clusterer(map, {
  preset: CLUSTER_PRESETS.RED, // –ö—Ä–∞—Å–Ω—ã–µ –∫–ª–∞—Å—Ç–µ—Ä—ã
  gridSize: 80,
  minClusterSize: 3
})

// –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Å–º–µ–Ω–∞ —Å—Ç–∏–ª—è
clusterer.setPreset(CLUSTER_PRESETS.DARK_GREEN)
```

### –ö–∞—Å—Ç–æ–º–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ balloon

```javascript
const clusterer = new Clusterer(map, {
  createBalloonContent: (placemarks) => {
    const count = placemarks.length
    let content = `<h3>–í –∫–ª–∞—Å—Ç–µ—Ä–µ ${count} –æ–±—ä–µ–∫—Ç–æ–≤</h3>`
    content += '<ul>'
    
    placemarks.slice(0, 5).forEach((pm, i) => {
      const data = pm.properties.get('balloonContent')
      content += `<li>${data}</li>`
    })
    
    if (count > 5) {
      content += `<li>... –∏ –µ—â–µ ${count - 5}</li>`
    }
    
    content += '</ul>'
    return content
  }
})
```

### –ö–∞—Å—Ç–æ–º–Ω–∞—è –∏–∫–æ–Ω–∫–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞

```javascript
const clusterer = new Clusterer(map, {
  calculateClusterIcon: (placemarks) => {
    const count = placemarks.length
    let color = '#0080ff' // —Å–∏–Ω–∏–π
    
    if (count > 100) {
      color = '#ff0000' // –∫—Ä–∞—Å–Ω—ã–π –¥–ª—è –±–æ–ª—å—à–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
    } else if (count > 50) {
      color = '#ff8800' // –æ—Ä–∞–Ω–∂–µ–≤—ã–π –¥–ª—è —Å—Ä–µ–¥–Ω–∏—Ö
    }
    
    return {
      iconColor: color,
      iconContent: count.toString()
    }
  }
})
```

### Vue: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è

```vue
<template>
  <div>
    <YMapsClusterer
      ref="clustererRef"
      :map="map"
      :placemarks="filteredMarkers"
      :preset="currentPreset"
      :grid-size="settings.gridSize"
      :min-cluster-size="settings.minSize"
      :auto-fit="true"
      @cluster-click="showClusterInfo"
    />
    
    <div class="settings">
      <label>
        –†–∞–∑–º–µ—Ä —Å–µ—Ç–∫–∏:
        <input 
          v-model.number="settings.gridSize" 
          type="range" 
          min="10" 
          max="200"
        />
        {{ settings.gridSize }}px
      </label>
      
      <label>
        –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä:
        <input 
          v-model.number="settings.minSize" 
          type="range" 
          min="2" 
          max="10"
        />
        {{ settings.minSize }} –º–µ—Ç–æ–∫
      </label>
      
      <label>
        –°—Ç–∏–ª—å:
        <select v-model="currentPreset">
          <option value="islands#blueClusterIcons">–°–∏–Ω–∏–π</option>
          <option value="islands#redClusterIcons">–ö—Ä–∞—Å–Ω—ã–π</option>
          <option value="islands#darkGreenClusterIcons">–ó–µ–ª–µ–Ω—ã–π</option>
          <option value="islands#violetClusterIcons">–§–∏–æ–ª–µ—Ç–æ–≤—ã–π</option>
        </select>
      </label>
      
      <button @click="refreshClusters">
        –û–±–Ω–æ–≤–∏—Ç—å –∫–ª–∞—Å—Ç–µ—Ä—ã
      </button>
    </div>
  </div>
</template>

<script setup>
import { ref, reactive, computed } from 'vue'

const clustererRef = ref()
const currentPreset = ref('islands#blueClusterIcons')

const settings = reactive({
  gridSize: 60,
  minSize: 2
})

const markers = ref([/* –º–∞—Å—Å–∏–≤ –º–µ—Ç–æ–∫ */])
const activeFilter = ref('all')

const filteredMarkers = computed(() => {
  if (activeFilter.value === 'all') {
    return markers.value
  }
  
  return markers.value.filter(marker => {
    // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    return marker.category === activeFilter.value
  })
})

const showClusterInfo = (cluster) => {
  const objects = cluster.getGeoObjects()
  console.log(`–ö–ª–∞—Å—Ç–µ—Ä —Å–æ–¥–µ—Ä–∂–∏—Ç ${objects.length} –æ–±—ä–µ–∫—Ç–æ–≤`)
}

const refreshClusters = () => {
  clustererRef.value?.refresh()
}
</script>
```

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏

```javascript
class OptimizedClusterer {
  constructor(map, options) {
    this.clusterer = new Clusterer(map, {
      ...options,
      // –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤
      gridSize: 100,
      viewportMargin: 50
    })
    
    this.batchSize = 100
    this.queue = []
  }
  
  async addBatch(placemarks) {
    // –î–æ–±–∞–≤–ª—è–µ–º –º–µ—Ç–∫–∏ –ø–æ—Ä—Ü–∏—è–º–∏
    for (let i = 0; i < placemarks.length; i += this.batchSize) {
      const batch = placemarks.slice(i, i + this.batchSize)
      await this.clusterer.add(batch)
      
      // –î–∞–µ–º –±—Ä–∞—É–∑–µ—Ä—É –æ—Ç–¥—ã—à–∞—Ç—å—Å—è
      await new Promise(resolve => setTimeout(resolve, 10))
    }
  }
  
  async loadFromAPI(url) {
    const response = await fetch(url)
    const data = await response.json()
    
    const placemarks = data.map(item => new Placemark(
      [item.lat, item.lng],
      { balloonContent: item.name }
    ))
    
    await this.addBatch(placemarks)
  }
}
```

## üé® Preset —Å—Ç–∏–ª–∏ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ü–≤–µ—Ç–∞
- `islands#blueClusterIcons` - —Å–∏–Ω–∏–π
- `islands#redClusterIcons` - –∫—Ä–∞—Å–Ω—ã–π
- `islands#darkGreenClusterIcons` - —Ç–µ–º–Ω–æ-–∑–µ–ª–µ–Ω—ã–π
- `islands#violetClusterIcons` - —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π
- `islands#blackClusterIcons` - —á–µ—Ä–Ω—ã–π
- `islands#grayClusterIcons` - —Å–µ—Ä—ã–π
- `islands#brownClusterIcons` - –∫–æ—Ä–∏—á–Ω–µ–≤—ã–π
- `islands#nightClusterIcons` - –Ω–æ—á–Ω–æ–π
- `islands#darkBlueClusterIcons` - —Ç–µ–º–Ω–æ-—Å–∏–Ω–∏–π
- `islands#darkOrangeClusterIcons` - —Ç–µ–º–Ω–æ-–æ—Ä–∞–Ω–∂–µ–≤—ã–π
- `islands#pinkClusterIcons` - —Ä–æ–∑–æ–≤—ã–π
- `islands#oliveClusterIcons` - –æ–ª–∏–≤–∫–æ–≤—ã–π

### –ò–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏
- `islands#invertedBlueClusterIcons`
- `islands#invertedRedClusterIcons`
- `islands#invertedDarkGreenClusterIcons`
- `islands#invertedVioletClusterIcons`

## ‚öôÔ∏è –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Å–µ—Ç–∫–∏**
   ```javascript
   // –î–ª—è 1000+ –º–µ—Ç–æ–∫
   gridSize: 80-100
   
   // –î–ª—è 10000+ –º–µ—Ç–æ–∫
   gridSize: 120-150
   ```

2. **–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Ç–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∑—É–º**
   ```javascript
   maxZoom: 14 // –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–µ—Ç–∫–∏ –Ω–∞ –±–æ–ª—å—à–æ–º –∑—É–º–µ
   ```

3. **–ó–∞–≥—Ä—É–∂–∞–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—Ä—Ü–∏—è–º–∏**
   ```javascript
   // –í–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ –±–æ–ª—å—à–æ–≥–æ –º–∞—Å—Å–∏–≤–∞
   await clusterer.add(smallBatch1)
   await clusterer.add(smallBatch2)
   ```

4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ viewport –º–∞—Ä–∂—É**
   ```javascript
   viewportMargin: 100 // –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –≤–∏–¥–∏–º–æ–π –æ–±–ª–∞—Å—Ç–∏
   ```

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ö–ª–∞—Å—Ç–µ—Ä—ã –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

```javascript
// –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ç–æ—Ä–∞
if (!clusterer.isReady()) {
  console.log('–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ç–æ—Ä –µ—â–µ –Ω–µ –≥–æ—Ç–æ–≤')
  return
}

// –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –º–µ—Ç–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã
console.log('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Ç–æ–∫:', clusterer.getPlacemarksCount())

// –û–±–Ω–æ–≤–∏—Ç–µ –∫–ª–∞—Å—Ç–µ—Ä—ã
clusterer.refresh()
```

### –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ/–º–∞–ª–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤

```javascript
// –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–∞–∑–º–µ—Ä —Å–µ—Ç–∫–∏
clusterer.setGridSize(100) // –£–≤–µ–ª–∏—á–∏—Ç—å –¥–ª—è –º–µ–Ω—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤

// –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä
clusterer.setMinClusterSize(5) // –£–≤–µ–ª–∏—á–∏—Ç—å –¥–ª—è –º–µ–Ω—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é

```javascript
// –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
const clusterer = new Clusterer(map, {
  gridSize: 120,
  maxZoom: 14,
  viewportMargin: 50,
  hasBalloon: false, // –û—Ç–∫–ª—é—á–∏—Ç—å balloon –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏
  hasHint: false     // –û—Ç–∫–ª—é—á–∏—Ç—å —Ö–∏–Ω—Ç—ã –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏
})
```

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏

- [YMapsCore](../../core/README.md) - –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã
- [Placemark](../Placemark/README.md) - –ú–µ—Ç–∫–∏ –Ω–∞ –∫–∞—Ä—Ç–µ
- [Balloon](../Balloon/README.md) - –í—Å–ø–ª—ã–≤–∞—é—â–∏–µ –æ–∫–Ω–∞

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–ú–æ–¥—É–ª—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –ø—Ä–æ–µ–∫—Ç–∞—Ö —Å Yandex Maps API.

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –∫–æ–º–∞–Ω–¥–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ SPA Platform.