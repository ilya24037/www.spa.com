<!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è (/additem) -->
<template>
    <Head title="–†–∞–∑–º–µ—Å—Ç–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ" />
    
    <!-- –û–±–µ—Ä—Ç–∫–∞ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –æ—Ç—Å—Ç—É–ø–∞–º–∏ –∫–∞–∫ –≤ Dashboard -->
    <div class="py-6 lg:py-8">
        
        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å –≥—ç–ø–æ–º –º–µ–∂–¥—É –±–ª–æ–∫–∞–º–∏ -->
        <div class="flex gap-6">
            
            <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —á–µ—Ä–µ–∑ SidebarWrapper -->
            <SidebarWrapper 
                v-model="showMobileSidebar"
                content-class="p-0"
                :show-desktop-header="false"
                :always-visible-desktop="true"
            >
                <!-- –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
                <div class="p-6 border-b">
                    <div class="flex items-center space-x-3">
                        <div 
                            class="w-12 h-12 rounded-full flex items-center justify-center text-white font-medium text-lg"
                            :style="{ backgroundColor: avatarColor }"
                        >
                            {{ userInitial }}
                        </div>
                        <div>
                            <div class="font-medium text-gray-900">{{ userName }}</div>
                            <div class="text-sm text-gray-500">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</div>
                        </div>
                    </div>
                </div>

                <!-- –ú–µ–Ω—é -->
                <nav class="p-4 space-y-1">
                    <Link 
                        href="/dashboard" 
                        :class="menuItemClass(isCurrentRoute('/dashboard'))"
                    >
                        <span>üìä Dashboard</span>
                    </Link>
                    <Link 
                        href="/additem" 
                        :class="menuItemClass(isCurrentRoute('/additem'))"
                    >
                        <span>‚ûï –†–∞–∑–º–µ—Å—Ç–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</span>
                    </Link>
                    <Link 
                        href="/profile" 
                        :class="menuItemClass(isCurrentRoute('/profile'))"
                    >
                        <span>üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</span>
                    </Link>
                </nav>
            </SidebarWrapper>

            <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
            <main class="flex-1">
                <ContentCard>
                    <template #header>
                        <!-- –•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏ -->
                        <nav class="flex mb-4" aria-label="Breadcrumb">
                            <ol class="inline-flex items-center space-x-1 md:space-x-3">
                                <li class="inline-flex items-center">
                                    <Link 
                                        href="/"
                                        class="text-gray-500 hover:text-gray-700 transition-colors"
                                    >
                                        –ì–ª–∞–≤–Ω–∞—è
                                    </Link>
                                    <svg 
                                        class="w-4 h-4 text-gray-400 mx-2" 
                                        fill="currentColor" 
                                        viewBox="0 0 20 20"
                                    >
                                        <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
                                    </svg>
                                </li>
                                <li>
                                    <span class="text-gray-900 font-medium">
                                        {{ selectedCategory ? getCategoryName(selectedCategory) : '–†–∞–∑–º–µ—Å—Ç–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ' }}
                                    </span>
                                </li>
                            </ol>
                        </nav>
                    </template>

                    <!-- –í—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –µ—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–µ –≤—ã–±—Ä–∞–Ω–∞) -->
                    <div v-if="!selectedCategory">
                        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
                        <div class="text-center mb-8">
                            <h1 class="text-3xl font-bold text-gray-900 mb-4">
                                –†–∞–∑–º–µ—Å—Ç–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
                            </h1>
                            <p class="text-lg text-gray-600">
                                –í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Å–ª—É–≥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è. –í–∞—à–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —É–≤–∏–¥—è—Ç —Ç—ã—Å—è—á–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤.
                            </p>
                        </div>

                        <!-- –°–µ—Ç–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                            <div
                                v-for="category in props.categories"
                                :key="category.id"
                                class="relative group"
                            >
                                <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
                                <button 
                                    @click="selectCategory(category.id)"
                                    type="button"
                                    class="w-full block bg-gray-50 rounded-xl p-6 hover:bg-gray-100 transition-all duration-300 transform hover:-translate-y-1 border-2 border-transparent hover:border-blue-200"
                                >
                                    <!-- –ü–æ–ø—É–ª—è—Ä–Ω—ã–π –ª–µ–π–±–ª -->
                                    <div v-if="category.popular" class="absolute top-4 right-4 z-10">
                                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                            ‚≠ê –ü–æ–ø—É–ª—è—Ä–Ω–æ–µ
                                        </span>
                                    </div>

                                    <!-- 18+ –ª–µ–π–±–ª -->
                                    <div v-if="category.adult" class="absolute top-4 left-4 z-10">
                                        <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800">
                                            üîû 18+
                                        </span>
                                    </div>

                                    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ -->
                                    <div class="text-center">
                                        <!-- –ò–∫–æ–Ω–∫–∞ -->
                                        <div class="flex items-center justify-center w-16 h-16 mx-auto mb-4 bg-white rounded-full shadow-sm">
                                            <span class="text-3xl">{{ category.icon }}</span>
                                        </div>

                                        <!-- –ù–∞–∑–≤–∞–Ω–∏–µ -->
                                        <h3 class="text-xl font-bold text-gray-900 mb-2">
                                            {{ category.name }}
                                        </h3>

                                        <!-- –û–ø–∏—Å–∞–Ω–∏–µ -->
                                        <p class="text-gray-600 text-sm mb-4">
                                            {{ category.description }}
                                        </p>

                                        <!-- –ö–Ω–æ–ø–∫–∞ -->
                                        <div class="flex justify-center">
                                            <span class="inline-flex items-center px-4 py-2 bg-blue-600 text-white font-medium rounded-lg text-sm group-hover:bg-blue-700 transition-colors">
                                                –í—ã–±—Ä–∞—Ç—å
                                                <svg class="w-4 h-4 ml-1 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                                </svg>
                                            </span>
                                        </div>
                                    </div>
                                </button>
                            </div>
                        </div>

                        <!-- –ü–æ—á–µ–º—É —Å—Ç–æ–∏—Ç —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —É –Ω–∞—Å -->
                        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 mb-8">
                            <h2 class="text-2xl font-bold text-gray-900 mb-6 text-center">
                                –ü–æ—á–µ–º—É —Å—Ç–æ–∏—Ç —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —É –Ω–∞—Å?
                            </h2>
                            
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div class="text-center">
                                    <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3">
                                        <span class="text-2xl">üëÅÔ∏è</span>
                                    </div>
                                    <h3 class="font-semibold text-gray-900 mb-2">–í—ã—Å–æ–∫–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å</h3>
                                    <p class="text-sm text-gray-600">–í–∞—à–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —É–≤–∏–¥—è—Ç —Ç—ã—Å—è—á–∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤</p>
                                </div>
                                
                                <div class="text-center">
                                    <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3">
                                        <span class="text-2xl">üí∞</span>
                                    </div>
                                    <h3 class="font-semibold text-gray-900 mb-2">–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ü–µ–Ω—ã</h3>
                                    <p class="text-sm text-gray-600">–†–∞–∑–º–µ—â–µ–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π –ø–æ –≤—ã–≥–æ–¥–Ω—ã–º —Ç–∞—Ä–∏—Ñ–∞–º</p>
                                </div>
                                
                                <div class="text-center">
                                    <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-3">
                                        <span class="text-2xl">‚ö°</span>
                                    </div>
                                    <h3 class="font-semibold text-gray-900 mb-2">–ë—ã—Å—Ç—Ä–∞—è –º–æ–¥–µ—Ä–∞—Ü–∏—è</h3>
                                    <p class="text-sm text-gray-600">–û–±—ä—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –∏ –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ —á–∞—Å–∞</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –≤—ã–±—Ä–∞–Ω–∞) -->
                    <div v-else>
                        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –∫–Ω–æ–ø–∫–æ–π "–ù–∞–∑–∞–¥" -->
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center space-x-4">
                                <button 
                                    @click="goBackToCategories"
                                    type="button"
                                    class="flex items-center text-gray-600 hover:text-gray-900 transition-colors"
                                >
                                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                                    </svg>
                                    –ù–∞–∑–∞–¥ –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
                                </button>
                                <div class="h-6 w-px bg-gray-300"></div>
                                <h1 class="text-2xl font-bold text-gray-900">
                                    {{ getCategoryName(selectedCategory) }}
                                </h1>
                            </div>
                        </div>

                        <!-- –§–æ—Ä–º–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏—è -->
                        <AdForm 
                            :category="selectedCategory"
                            :categories="props.categories"
                            @success="handleFormSuccess"
                        />
                    </div>
                </ContentCard>
            </main>
        </div>
    </div>
</template>

<script setup>
import { ref, computed } from 'vue'
import { Head, Link, usePage } from '@inertiajs/vue3'
import AppLayout from '@/Layouts/AppLayout.vue'
import SidebarWrapper from '@/Components/Layout/SidebarWrapper.vue'
import ContentCard from '@/Components/Layout/ContentCard.vue'
import AdForm from '@/Components/Form/AdForm.vue'

// –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
const props = defineProps({
  categories: {
    type: Array,
    required: true
  },
  breadcrumbs: {
    type: Array,
    required: true
  },
  counts: {
    type: Object,
    default: () => ({})
  },
  userStats: {
    type: Object,
    default: () => ({})
  }
})

// –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
const selectedCategory = ref(null)

// –°–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é
const showMobileSidebar = ref(false)

// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–∫–æ–ø–∏—Ä—É–µ–º –ª–æ–≥–∏–∫—É –∏–∑ Dashboard)
const page = usePage()
const user = computed(() => page.props.auth?.user || {})
const userName = computed(() => user.value.name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å')
const userInitial = computed(() => userName.value.charAt(0).toUpperCase())

// –¶–≤–µ—Ç –∞–≤–∞—Ç–∞—Ä–∞
const colors = ['#e91e63', '#9c27b0', '#673ab7', '#3f51b5', '#2196f3', '#00bcd4', '#009688', '#4caf50', '#ff9800', '#ff5722']
const avatarColor = computed(() => {
    const charCode = userName.value.charCodeAt(0) || 85
    return colors[charCode % colors.length]
})

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Ä–æ—É—Ç–∞
const isCurrentRoute = (routeName) => {
    return page.url.includes(routeName)
}

// –ö–ª–∞—Å—Å –¥–ª—è –ø—É–Ω–∫—Ç–æ–≤ –º–µ–Ω—é
const menuItemClass = (isActive) => [
    'flex items-center justify-between px-3 py-2 text-sm rounded-lg transition',
    isActive 
        ? 'bg-blue-50 text-blue-600 font-medium' 
        : 'text-gray-700 hover:bg-gray-50'
]

// –ú–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
const selectCategory = (categoryId) => {
    selectedCategory.value = categoryId
}

const goBackToCategories = () => {
    selectedCategory.value = null
}

const getCategoryName = (categoryId) => {
    const category = props.categories.find(cat => cat.id === categoryId)
    return category ? category.name : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è'
}

const handleFormSuccess = (data) => {
    // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∏–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    console.log('–û–±—ä—è–≤–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ:', data)
    // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏–ª–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
}
</script>

<script>
export default {
    layout: AppLayout
}
</script>