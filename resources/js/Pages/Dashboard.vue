<!-- Dashboard - –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –≤ —Å—Ç–∏–ª–µ Avito —Å –ø–æ–ª–Ω–æ–π FSD –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π -->
<template>
  <Head title="–ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è" />
  
  <!-- –û–±–µ—Ä—Ç–∫–∞ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –æ—Ç—Å—Ç—É–ø–∞–º–∏ –∫–∞–∫ –≤ Home.vue -->
  <div class="py-6 lg:py-8">
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å –≥—ç–ø–æ–º –º–µ–∂–¥—É –±–ª–æ–∫–∞–º–∏ -->
    <div class="flex gap-6">
      
      <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —á–µ—Ä–µ–∑ SidebarWrapper -->
      <SidebarWrapper 
        v-model="showSidebar"
        content-class="p-0"
        :show-desktop-header="false"
        :always-visible-desktop="true"
      >
        <!-- –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
        <div class="p-6 border-b">
          <div class="flex items-center space-x-3">
            <div 
              class="w-12 h-12 rounded-full flex items-center justify-center text-white font-medium text-lg"
              :style="{ backgroundColor: avatarColor }"
            >
              {{ userInitial }}
            </div>
            <div>
              <div class="font-medium text-gray-900">{{ userName }}</div>
              <div class="text-sm text-gray-500">‚òÖ {{ userStats.rating || 4.2 }} ‚Ä¢ {{ userStats.reviews_count || 5 }} –æ—Ç–∑—ã–≤–æ–≤</div>
            </div>
          </div>
        </div>
        
        <!-- –ú–µ–Ω—é –∫–∞–∫ –Ω–∞ –ê–≤–∏—Ç–æ -->
        <nav class="flex-1">
          <div class="py-2">
            <!-- –ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è (–æ—Å–Ω–æ–≤–Ω–∞—è —Å–µ–∫—Ü–∏—è) -->
            <div class="px-4">
              <Link 
                href="/profile/items/inactive/all"
                :class="[
                  'flex items-center justify-between px-3 py-2 text-sm rounded-md transition-colors',
                  isAdsRoute ? 'bg-blue-50 text-blue-700 font-medium' : 'text-gray-700 hover:bg-gray-50'
                ]"
              >
                <span>–ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</span>
                <span v-if="totalAds > 0" class="text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded-full">{{ totalAds }}</span>
              </Link>
            </div>
            
            <!-- –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø—É–Ω–∫—Ç—ã –º–µ–Ω—é -->
            <div class="px-4 mt-2 space-y-1">
              <Link 
                href="/bookings"
                class="flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md transition-colors"
              >
                –ó–∞–∫–∞–∑—ã
              </Link>
              
              <Link 
                href="/profile/reviews"
                class="flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md transition-colors"
              >
                –ú–æ–∏ –æ—Ç–∑—ã–≤—ã
              </Link>
              
              <Link 
                href="/favorites"
                class="flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md transition-colors"
              >
                –ò–∑–±—Ä–∞–Ω–Ω–æ–µ
              </Link>
              
              <Link 
                href="/messages"
                class="flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md transition-colors"
              >
                –°–æ–æ–±—â–µ–Ω–∏—è
              </Link>
              
              <Link 
                href="/notifications"
                class="flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md transition-colors"
              >
                –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
              </Link>
              
              <Link 
                href="/wallet"
                class="flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md transition-colors"
              >
                –ö–æ—à–µ–ª—ë–∫
              </Link>
              
              <Link 
                href="/profile/addresses"
                class="flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md transition-colors"
              >
                –ê–¥—Ä–µ—Å–∞
              </Link>
              
              <Link 
                href="/profile/edit"
                class="flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md transition-colors"
              >
                –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–º
              </Link>
              
              <Link 
                href="/profile/security"
                class="flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md transition-colors"
              >
                –ó–∞—â–∏—Ç–∞ –ø—Ä–æ—Ñ–∏–ª—è
              </Link>
              
              <Link 
                href="/settings"
                class="flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md transition-colors"
              >
                –ù–∞—Å—Ç—Ä–æ–π–∫–∏
              </Link>
              
              <Link
                href="/services"
                class="flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md transition-colors"
              >
                –ü–ª–∞—Ç–Ω—ã–µ —É—Å–ª—É–≥–∏
              </Link>
            </div>

            <!-- –ê–¥–º–∏–Ω—Å–∫–æ–µ –º–µ–Ω—é -->
            <div v-if="$page.props.auth?.user?.role === 'admin' || $page.props.auth?.user?.role === 'moderator'"
                 class="px-4 mt-4 pt-4 border-t space-y-1">
              <div class="px-3 mb-2">
                <span class="text-xs font-semibold text-gray-500 uppercase">
                  üõ°Ô∏è –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ
                </span>
              </div>

              <a
                href="/admin/ads"
                class="flex items-center justify-between px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md transition-colors"
                title="–ú–æ–¥–µ—Ä–∞—Ü–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π (–Ω–æ–≤–∞—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Filament)"
              >
                <span>üìù –ú–æ–¥–µ—Ä–∞—Ü–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π</span>
                <span v-if="$page.props.pendingCount" class="bg-red-100 text-red-700 text-xs px-2 py-0.5 rounded-full">
                  {{ $page.props.pendingCount }}
                </span>
              </a>

              <a
                href="/admin/ads"
                class="flex items-center justify-between px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md transition-colors"
                :class="{ 'bg-gray-100': $page.url.includes('/admin/ads') }"
                title="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è–º–∏ (–Ω–æ–≤–∞—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Filament)"
              >
                <span>üìã –í—Å–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</span>
                <span v-if="props.stats?.all" class="bg-gray-100 text-gray-700 text-xs px-2 py-0.5 rounded-full">
                  {{ props.stats.all }}
                </span>
              </a>

              <a
                href="/admin/reviews"
                class="flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md transition-colors"
                title="–ú–æ–¥–µ—Ä–∞—Ü–∏—è –æ—Ç–∑—ã–≤–æ–≤ (–Ω–æ–≤–∞—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Filament)"
              >
                <span>‚≠ê –ú–æ–¥–µ—Ä–∞—Ü–∏—è –æ—Ç–∑—ã–≤–æ–≤</span>
              </a>

              <a
                href="/admin/complaints"
                class="flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md transition-colors"
                title="–°–∏—Å—Ç–µ–º–∞ –∂–∞–ª–æ–± (–Ω–æ–≤–∞—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Filament)"
              >
                <span>‚ö†Ô∏è –ñ–∞–ª–æ–±—ã</span>
              </a>

              <a
                v-if="$page.props.auth?.user?.role === 'admin'"
                href="/admin/users"
                class="flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md transition-colors"
                title="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (–Ω–æ–≤–∞—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Filament)"
              >
                <span>üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</span>
              </a>

              <a
                v-if="$page.props.auth?.user?.role === 'admin'"
                href="/admin/master-profiles"
                class="flex items-center px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md transition-colors"
                title="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä–∞–º–∏ (–Ω–æ–≤–∞—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Filament)"
              >
                <span>üíÜ –ú–∞—Å—Ç–µ—Ä–∞</span>
              </a>

              <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ –ø–æ–ª–Ω—É—é –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å -->
              <div class="mt-4 px-3">
                <a
                  href="/admin"
                  target="_blank"
                  class="flex items-center justify-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 transition-colors"
                  title="–û—Ç–∫—Ä—ã—Ç—å –ø–æ–ª–Ω—É—é –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Filament"
                >
                  <svg class="w-4 h-4 mr-2"
                       fill="none"
                       stroke="currentColor"
                       viewBox="0 0 24 24">
                    <path stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                  </svg>
                  –ü–æ–ª–Ω–∞—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
                </a>
              </div>
            </div>
          </div>

          <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ (–¥–ª—è –∞–¥–º–∏–Ω–æ–≤) -->
          <div v-if="$page.props.auth?.user?.role === 'admin' && moderationStats" class="mt-6 p-4 bg-blue-50 rounded-lg">
            <h3 class="text-sm font-semibold text-blue-900 mb-3">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</h3>
            <div class="space-y-2 text-sm">
              <div class="flex justify-between">
                <span class="text-blue-700">–ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏:</span>
                <span class="font-medium text-blue-900">{{ moderationStats.pending || 0 }}</span>
              </div>
              <div class="flex justify-between">
                <span class="text-blue-700">–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ —Å–µ–≥–æ–¥–Ω—è:</span>
                <span class="font-medium text-green-700">{{ moderationStats.processedToday || 0 }}</span>
              </div>
              <div class="flex justify-between">
                <span class="text-blue-700">–û—Ç–∫–ª–æ–Ω–µ–Ω–æ —Å–µ–≥–æ–¥–Ω—è:</span>
                <span class="font-medium text-red-700">{{ moderationStats.rejectedToday || 0 }}</span>
              </div>
              <div class="flex justify-between">
                <span class="text-blue-700">–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è:</span>
                <span class="font-medium text-blue-900">{{ moderationStats.avgTime || '~15 –º–∏–Ω' }}</span>
              </div>
            </div>

            <!-- –ú–∏–Ω–∏-–≥—Ä–∞—Ñ–∏–∫ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) -->
            <div v-if="moderationStats.weekData" class="mt-3 pt-3 border-t border-blue-200">
              <div class="flex items-end justify-between h-12 gap-1">
                <div
                  v-for="(count, day) in moderationStats.weekData"
                  :key="day"
                  class="flex-1 bg-blue-300 rounded-t transition-all hover:bg-blue-400"
                  :style="`height: ${Math.min(100, count * 5)}%`"
                  :title="`${day}: ${count}`"
                ></div>
              </div>
              <div class="text-xs text-blue-600 mt-1">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π</div>
            </div>
          </div>
        </nav>
      </SidebarWrapper>

      <!-- –ö–æ–Ω—Ç–µ–Ω—Ç —Å–ø—Ä–∞–≤–∞ -->
      <section class="flex-1 space-y-6">
        
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –±–µ–∑ —Ñ–æ–Ω–∞ -->
        <div class="mb-6">
          <h1 class="text-2xl font-bold text-gray-900 mb-4">–ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</h1>
        </div>
        
        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç - –±–µ–ª–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –∫–∞–∫ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200">
          <div class="p-6">
            <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –≤–∫–ª–∞–¥–æ–∫ –∫–∞–∫ –Ω–∞ –ê–≤–∏—Ç–æ -->
            <div v-if="!props.adminMode" class="flex items-center space-x-8">
              <Link
                href="/profile/items/inactive/all"
                :class="[
                  'pb-2 text-base font-medium border-b-2 transition-colors',
                  activeTab === 'inactive' 
                    ? 'text-gray-900 border-gray-900' 
                    : 'text-gray-500 border-transparent hover:text-gray-700'
                ]"
              >
                <span class="flex items-center gap-2">
                  –ñ–¥—É—Ç –¥–µ–π—Å—Ç–≤–∏–π
                  <sup v-if="counts.waiting_payment" class="text-sm font-normal">{{ counts.waiting_payment }}</sup>
                </span>
              </Link>
              
              <Link 
                href="/profile/items/active/all"
                :class="[
                  'pb-2 text-base font-medium border-b-2 transition-colors',
                  activeTab === 'active' 
                    ? 'text-gray-900 border-gray-900' 
                    : 'text-gray-500 border-transparent hover:text-gray-700'
                ]"
              >
                <span class="flex items-center gap-2">
                  –ê–∫—Ç–∏–≤–Ω—ã–µ
                  <sup v-if="counts.active" class="text-sm font-normal">{{ counts.active }}</sup>
                </span>
              </Link>
              
              <Link 
                href="/profile/items/draft/all"
                :class="[
                  'pb-2 text-base font-medium border-b-2 transition-colors',
                  activeTab === 'draft' 
                    ? 'text-gray-900 border-gray-900' 
                    : 'text-gray-500 border-transparent hover:text-gray-700'
                ]"
              >
                <span class="flex items-center gap-2">
                  –ß–µ—Ä–Ω–æ–≤–∏–∫–∏
                  <sup v-if="counts.draft" class="text-sm font-normal">{{ counts.draft }}</sup>
                </span>
              </Link>
              
              <Link 
                href="/profile/items/archive/all"
                :class="[
                  'pb-2 text-base font-medium border-b-2 transition-colors',
                  activeTab === 'archive' 
                    ? 'text-gray-900 border-gray-900' 
                    : 'text-gray-500 border-transparent hover:text-gray-700'
                ]"
              >
                <span class="flex items-center gap-2">
                  –ê—Ä—Ö–∏–≤
                  <sup v-if="counts.archive" class="text-sm font-normal">{{ counts.archive }}</sup>
                </span>
              </Link>
            </div>

            <!-- –ê–¥–º–∏–Ω—Å–∫–∏–µ —Ç–∞–±—ã -->
            <div v-if="props.adminMode" class="flex items-center space-x-8 overflow-x-auto">
              <a
                href="/admin/ads"
                class="pb-2 text-base font-medium border-b-2 transition-colors whitespace-nowrap text-gray-500 border-transparent hover:text-gray-700"
              >
                <span class="flex items-center gap-2">
                  –í—Å–µ (–≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏)
                  <sup v-if="props.stats?.all" class="text-sm font-normal">{{ props.stats.all }}</sup>
                </span>
              </a>

              <a
                href="/admin/ads"
                class="pb-2 text-base font-medium border-b-2 transition-colors whitespace-nowrap text-gray-500 border-transparent hover:text-gray-700"
              >
                <span class="flex items-center gap-2">
                  –ê–∫—Ç–∏–≤–Ω—ã–µ (–≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏)
                  <sup v-if="props.stats?.active" class="text-sm font-normal">{{ props.stats.active }}</sup>
                </span>
              </a>

              <a
                href="/admin/ads"
                class="pb-2 text-base font-medium border-b-2 transition-colors whitespace-nowrap text-gray-500 border-transparent hover:text-gray-700"
              >
                <span class="flex items-center gap-2">
                  –ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ (–≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏)
                  <sup v-if="props.stats?.moderation" class="text-sm font-normal">{{ props.stats.moderation }}</sup>
                </span>
              </a>

              <a
                href="/admin/ads"
                class="pb-2 text-base font-medium border-b-2 transition-colors whitespace-nowrap text-gray-500 border-transparent hover:text-gray-700"
              >
                <span class="flex items-center gap-2">
                  –ß–µ—Ä–Ω–æ–≤–∏–∫–∏ (–≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏)
                  <sup v-if="props.stats?.draft" class="text-sm font-normal">{{ props.stats.draft }}</sup>
                </span>
              </a>

              <a
                href="/admin/ads"
                class="pb-2 text-base font-medium border-b-2 transition-colors whitespace-nowrap text-gray-500 border-transparent hover:text-gray-700"
              >
                <span class="flex items-center gap-2">
                  –û—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–µ (–≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏)
                  <sup v-if="props.stats?.rejected" class="text-sm font-normal">{{ props.stats.rejected }}</sup>
                </span>
              </a>

              <a
                href="/admin/ads"
                class="pb-2 text-base font-medium border-b-2 transition-colors whitespace-nowrap text-gray-500 border-transparent hover:text-gray-700"
              >
                <span class="flex items-center gap-2">
                  –ê—Ä—Ö–∏–≤ (–≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏)
                  <sup v-if="props.stats?.archived" class="text-sm font-normal">{{ props.stats.archived }}</sup>
                </span>
              </a>
            </div>
          </div>

          <!-- –ü–∞–Ω–µ–ª—å –º–∞—Å—Å–æ–≤—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è –∞–¥–º–∏–Ω–æ–≤ -->
          <div v-if="props.adminMode && selectedItems.size > 0" class="px-6 py-4 bg-blue-50 border-b border-blue-200">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-4">
                <span class="text-sm font-medium text-blue-900">
                  –í—ã–±—Ä–∞–Ω–æ: {{ selectedItems.size }} {{ getItemsLabel(selectedItems.size) }}
                </span>
                <button
                  @click="clearSelection"
                  class="text-sm text-blue-600 hover:text-blue-700 underline"
                >
                  –°–Ω—è—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ
                </button>
              </div>

              <div class="flex items-center gap-2">
                <button
                  @click="bulkAction('approve')"
                  :disabled="isBulkActionLoading"
                  class="px-4 py-2 bg-green-600 text-white text-sm rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                >
                  ‚úÖ –û–¥–æ–±—Ä–∏—Ç—å
                </button>

                <button
                  @click="bulkAction('reject')"
                  :disabled="isBulkActionLoading"
                  class="px-4 py-2 bg-red-600 text-white text-sm rounded-md hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                >
                  ‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å
                </button>

                <button
                  @click="bulkAction('block')"
                  :disabled="isBulkActionLoading"
                  class="px-4 py-2 bg-orange-600 text-white text-sm rounded-md hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                >
                  üö´ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
                </button>

                <button
                  @click="bulkAction('archive')"
                  :disabled="isBulkActionLoading"
                  class="px-4 py-2 bg-gray-600 text-white text-sm rounded-md hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                >
                  üì¶ –í –∞—Ä—Ö–∏–≤
                </button>

                <button
                  @click="bulkAction('delete')"
                  :disabled="isBulkActionLoading"
                  class="px-4 py-2 bg-red-800 text-white text-sm rounded-md hover:bg-red-900 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                >
                  üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                </button>
              </div>
            </div>
          </div>

          <!-- –í—ã–±—Ä–∞—Ç—å –≤—Å–µ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤ -->
          <div v-if="props.adminMode && profiles && profiles.length > 0" class="px-6 pt-4">
            <label class="flex items-center gap-2 cursor-pointer hover:text-blue-600 transition-colors">
              <input
                type="checkbox"
                :checked="isAllSelected"
                @change="toggleSelectAll"
                class="w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"
              />
              <span class="text-sm font-medium">
                –í—ã–±—Ä–∞—Ç—å –≤—Å–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
              </span>
            </label>
          </div>

          <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–∫–∏ -->
          <div v-if="profiles && profiles.length > 0" class="space-y-6 p-6">
            <div
              v-for="profile in profiles"
              :key="profile.id"
              class="relative"
            >
              <!-- –ß–µ–∫–±–æ–∫—Å –¥–ª—è –∞–¥–º–∏–Ω–æ–≤ -->
              <div v-if="props.adminMode" class="absolute top-4 left-4 z-10">
                <input
                  type="checkbox"
                  :checked="selectedItems.has(profile.id)"
                  @change="toggleItemSelection(profile.id)"
                  class="w-5 h-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500 cursor-pointer"
                  :aria-label="`–í—ã–±—Ä–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ #${profile.id}`"
                />
              </div>

              <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —Ä–µ–∂–∏–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
              <div v-if="props.userManagementMode" class="bg-white rounded-lg shadow-sm border border-gray-200 p-4">
                <div class="flex items-center justify-between">
                  <div class="flex-1">
                    <h3 class="font-semibold text-gray-900">{{ profile.title }}</h3>
                    <p class="text-sm text-gray-600 mt-1">{{ profile.email }}</p>
                    <div class="flex items-center gap-4 mt-2 text-sm text-gray-500">
                      <span>–†–æ–ª—å: <span class="font-medium">{{ profile.role }}</span></span>
                      <span>–°—Ç–∞—Ç—É—Å: <span class="font-medium" :class="profile.status === 'active' ? 'text-green-600' : 'text-red-600'">{{ profile.status }}</span></span>
                      <span v-if="profile.email_verified_at" class="text-green-600">‚úì Email –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω</span>
                      <span v-else class="text-orange-600">‚ö† Email –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω</span>
                    </div>
                  </div>
                  <div class="flex items-center gap-2">
                    <button
                      @click="window.location.href = '/admin/users'"
                      class="px-4 py-2 text-sm font-medium rounded-md transition-colors"
                      :class="profile.status === 'active' ? 'bg-red-600 text-white hover:bg-red-700' : 'bg-green-600 text-white hover:bg-green-700'"
                    >
                      {{ profile.status === 'active' ? '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å' : '–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å' }}
                    </button>
                  </div>
                </div>
              </div>

              <!-- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏—è -->
              <ItemCard
                v-else
                :item="profile"
                :key="`${profile.id}-${profile.status}`"
                :class="{ 'pl-12': props.adminMode }"
                @item-updated="handleItemUpdate"
                @item-deleted="handleItemDelete"
                @item-error="handleItemError"
                @pay="handleItemPay"
                @promote="handleItemPromote"
                @edit="handleItemEdit"
                @deactivate="handleItemDeactivate"
                @delete="handleItemDelete"
                @mark-irrelevant="handleItemMarkIrrelevant"
                @book="handleItemBook"
                @publish="handleItemPublish"
              />
            </div>
          </div>
          
          <!-- –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–∞–∫ –Ω–∞ –ê–≤–∏—Ç–æ -->
          <div v-else class="text-center py-16">
            <div class="max-w-md mx-auto">
              <div class="w-20 h-20 mx-auto mb-6 bg-gray-100 rounded-full flex items-center justify-center">
                <svg class="w-10 h-10 text-gray-400"
                     fill="none"
                     stroke="currentColor"
                     viewBox="0 0 24 24">
                  <path stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                </svg>
              </div>
              <h3 class="text-xl font-medium text-gray-900 mb-3">{{ getEmptyStateTitle(activeTab) }}</h3>
              <p class="text-gray-600 mb-8 leading-relaxed">{{ getEmptyStateDescription(activeTab) }}</p>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>
  
  <!-- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
  <Toast
    v-for="toast in toasts"
    :key="toast.id"
    :message="toast.message"
    :type="toast.type"
    :duration="toast.duration"
    @close="removeToast(toast.id)"
  />
</template>

<script setup lang="ts">
import { ref, computed } from 'vue'
import { Head, Link, usePage, router } from '@inertiajs/vue3'

// FSD imports
import { SidebarWrapper } from '@/src/shared/ui/layouts/SidebarWrapper'
import { ItemCard } from '@/src/entities/ad/ui/ItemCard'
import { Toast } from '@/src/shared/ui/molecules/Toast'
import type { AdItem } from '@/src/entities/ad/ui/ItemCard'
import type { ToastType } from '@/src/shared/ui/molecules/Toast'

// TypeScript –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
interface DashboardPageProps {
  profiles?: AdItem[]
  counts?: {
    active?: number
    draft?: number
    waiting_payment?: number
    old?: number
    archive?: number
    unreadMessages?: number
  }
  userStats?: {
    rating?: number
    reviews_count?: number
  }
  activeTab?: string
  title?: string
  moderationMode?: boolean
  pendingCount?: number
  isAdmin?: boolean
  adminMode?: boolean
  userManagementMode?: boolean
  stats?: Record<string, number>
  pagination?: {
    total?: number
    current?: number
    per_page?: number
  }
  moderationStats?: {
    pending?: number
    processedToday?: number
    rejectedToday?: number
    avgTime?: string
    weekData?: Record<string, number>
  }
}

interface ToastInstance {
  id: number
  message: string
  type: ToastType
  duration: number
}

// Props
const props = withDefaults(defineProps<DashboardPageProps>(), {
  profiles: () => [],
  counts: () => ({}),
  userStats: () => ({}),
  activeTab: 'active', // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ
  title: '–ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è',
  moderationStats: () => ({})
})

// –°–æ—Å—Ç–æ—è–Ω–∏–µ
const showSidebar = ref(false)
const toasts = ref<ToastInstance[]>([])
const selectedItems = ref<Set<number>>(new Set())
const isBulkActionLoading = ref(false)

// –î–æ–±–∞–≤–∏–º —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
const moderationStats = computed(() => props.moderationStats || {})

// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
const page = usePage()
const user = computed(() => (page.props.auth as any)?.user || {})

// –í—ã—á–∏—Å–ª—è–µ–º—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const userName = computed(() => user.value.name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å')
const userInitial = computed(() => userName.value.charAt(0).toUpperCase())
const avatarColor = computed(() => {
  const colors = ['#ef4444', '#f97316', '#eab308', '#22c55e', '#06b6d4', '#3b82f6', '#8b5cf6', '#ec4899']
  const index = userName.value.charCodeAt(0) % colors.length
  return colors[index]
})

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Ä–æ—É—Ç–∞ –¥–ª—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π
const isAdsRoute = computed(() => {
  const currentRoute = page.url
  return currentRoute.includes('/profile/items/')
})

// –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–π
const totalAds = computed(() => {
  const counts = props.counts || {}
  return (counts.active || 0) + (counts.draft || 0) + (counts.waiting_payment || 0) + (counts.old || 0) + (counts.archive || 0)
})

// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∏ –æ–ø–∏—Å–∞–Ω–∏–π

const getEmptyStateTitle = (tab: string) => {
  const titles: Record<string, string> = {
    active: '–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π',
    draft: '–ù–µ—Ç —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤',
    inactive: '–ù–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π, –æ–∂–∏–¥–∞—é—â–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π',
    old: '–ù–µ—Ç —Å—Ç–∞—Ä—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π',
    archive: '–ê—Ä—Ö–∏–≤ –ø—É—Å—Ç'
  }
  return titles[tab] || '–ù–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π'
}

const getEmptyStateDescription = (tab: string) => {
  const descriptions: Record<string, string> = {
    active: '–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π. –†–∞–∑–º–µ—Å—Ç–∏—Ç–µ –Ω–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –ø–æ–ª—É—á–∞—Ç—å –∑–∞–∫–∞–∑—ã.',
    draft: '–£ –≤–∞—Å –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –∏–ª–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ç–µ–∫—É—â–µ–µ –∫–∞–∫ —á–µ—Ä–Ω–æ–≤–∏–∫.',
    inactive: '–ó–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –≤–∞—à–µ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è - –Ω–∞–ø—Ä–∏–º–µ—Ä, –∏—Å—Ç–µ–∫–∞—é—â–∏–µ –∏–ª–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–µ.',
    old: '–ó–¥–µ—Å—å –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã –≤–∞—à–∏ —Å—Ç–∞—Ä—ã–µ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è.',
    archive: '–ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –ø–æ–∏—Å–∫–µ, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.'
  }
  return descriptions[tab] || '–ü–æ–∫–∞ –∑–¥–µ—Å—å –ø—É—Å—Ç–æ.'
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
const handleItemUpdate = (itemId: number) => {
  addToast(`–û–±—ä—è–≤–ª–µ–Ω–∏–µ #${itemId} –æ–±–Ω–æ–≤–ª–µ–Ω–æ`, 'success')
  // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
  router.reload({
    only: ['profiles', 'counts'],
    preserveScroll: true
  } as any)
}

const handleItemDelete = (itemId: number) => {
  addToast(`–û–±—ä—è–≤–ª–µ–Ω–∏–µ #${itemId} —É–¥–∞–ª–µ–Ω–æ`, 'info')
  // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è
  router.reload({
    only: ['profiles', 'counts'],
    preserveScroll: true
  } as any)
}

/**
 * Production-ready –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤–º–µ—Å—Ç–æ alert()
 * –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
 */
const handleItemError = (itemId: number, message: string) => {
  addToast(`–û–±—ä—è–≤–ª–µ–Ω–∏–µ #${itemId}: ${message}`, 'error')
}

const handleItemPay = (itemId: number) => {
  addToast(`–ü–µ—Ä–µ—Ö–æ–¥ –∫ –æ–ø–ª–∞—Ç–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è #${itemId}`, 'info')
}

const handleItemPromote = (itemId: number) => {
  addToast(`–ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è #${itemId}`, 'info')
}

const handleItemEdit = (itemId: number) => {
  addToast(`–ü–µ—Ä–µ—Ö–æ–¥ –∫ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –æ–±—ä—è–≤–ª–µ–Ω–∏—è #${itemId}`, 'info')
}

const handleItemDeactivate = (itemId: number) => {
  addToast(`–û–±—ä—è–≤–ª–µ–Ω–∏–µ #${itemId} –ø–µ—Ä–µ–º–µ—â–µ–Ω–æ –≤ –∞—Ä—Ö–∏–≤`, 'success')
  // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏
  router.reload({
    only: ['profiles', 'counts'],
    preserveScroll: true
  } as any)
}

const handleItemMarkIrrelevant = (itemId: number) => {
  addToast(`–û–±—ä—è–≤–ª–µ–Ω–∏–µ #${itemId} –ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω–æ–µ`, 'info')
  // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
  router.reload({
    only: ['profiles', 'counts'],
    preserveScroll: true
  } as any)
}

const handleItemBook = (itemId: number) => {
  addToast(`–ü–µ—Ä–µ—Ö–æ–¥ –∫ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—é –æ–±—ä—è–≤–ª–µ–Ω–∏—è #${itemId}`, 'info')
}

const handleItemPublish = (itemId: number) => {
  addToast(`–û–±—ä—è–≤–ª–µ–Ω–∏–µ #${itemId} –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é`, 'success')
  // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤
  router.reload({
    only: ['profiles', 'counts'],
    preserveScroll: true
  } as any)
}

// –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
const addToast = (message: string, type: ToastType = 'success', duration = 5000) => {
  const id = Date.now()
  toasts.value.push({ id, message, type, duration })
}

const removeToast = (id: number) => {
  toasts.value = toasts.value.filter(toast => toast.id !== id)
}

// –ú–µ—Ç–æ–¥—ã –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
const toggleItemSelection = (itemId: number) => {
  if (selectedItems.value.has(itemId)) {
    selectedItems.value.delete(itemId)
  } else {
    selectedItems.value.add(itemId)
  }
}

const toggleSelectAll = () => {
  if (isAllSelected.value) {
    clearSelection()
  } else {
    props.profiles?.forEach(profile => {
      selectedItems.value.add(profile.id)
    })
  }
}

const clearSelection = () => {
  selectedItems.value.clear()
}

const isAllSelected = computed(() => {
  if (!props.profiles || props.profiles.length === 0) return false
  return props.profiles.every(profile => selectedItems.value.has(profile.id))
})

const getItemsLabel = (count: number) => {
  if (count === 1) return '–æ–±—ä—è–≤–ª–µ–Ω–∏–µ'
  if (count >= 2 && count <= 4) return '–æ–±—ä—è–≤–ª–µ–Ω–∏—è'
  return '–æ–±—ä—è–≤–ª–µ–Ω–∏–π'
}

const bulkAction = async (action: string) => {
  if (selectedItems.value.size === 0) {
    addToast('–í—ã–±–µ—Ä–∏—Ç–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –¥–ª—è –¥–µ–π—Å—Ç–≤–∏—è', 'warning')
    return
  }

  const confirmMessages: Record<string, string> = {
    approve: `–û–¥–æ–±—Ä–∏—Ç—å ${selectedItems.value.size} ${getItemsLabel(selectedItems.value.size)}?`,
    reject: `–û—Ç–∫–ª–æ–Ω–∏—Ç—å ${selectedItems.value.size} ${getItemsLabel(selectedItems.value.size)}?`,
    block: `–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å ${selectedItems.value.size} ${getItemsLabel(selectedItems.value.size)}?`,
    archive: `–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ –∞—Ä—Ö–∏–≤ ${selectedItems.value.size} ${getItemsLabel(selectedItems.value.size)}?`,
    delete: `–£–¥–∞–ª–∏—Ç—å ${selectedItems.value.size} ${getItemsLabel(selectedItems.value.size)}? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!`
  }

  if (!confirm(confirmMessages[action])) {
    return
  }

  isBulkActionLoading.value = true

  // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –Ω–æ–≤—É—é –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Filament –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
  window.location.href = '/admin/ads'
  return;

  /*router.post('/profile/admin/ads/bulk', {
    ids: Array.from(selectedItems.value),
    action: action
  }, {
    preserveScroll: true,
    preserveState: false,
    onStart: () => {
      isBulkActionLoading.value = true
    },
    onSuccess: (page) => {
      const flash = (page.props as any).flash
      addToast(flash?.success || `–î–µ–π—Å—Ç–≤–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ`, 'success')
      clearSelection()
      isBulkActionLoading.value = false
    },
    onError: (errors) => {
      console.error('Bulk action error:', errors)
      addToast('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –¥–µ–π—Å—Ç–≤–∏—è', 'error')
      isBulkActionLoading.value = false
    },
    onFinish: () => {
      isBulkActionLoading.value = false
    }
  })*/
}

// –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ –¥–ª—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
import { onMounted, onUnmounted } from 'vue'

const setupHotkeys = () => {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–¥–º–∏–Ω –∏–ª–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä
  if (!user.value.role || !['admin', 'moderator'].includes(user.value.role)) {
    return
  }

  const handleKeyPress = (e: KeyboardEvent) => {
    // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º, –µ—Å–ª–∏ —Ñ–æ–∫—É—Å –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
    if (e.target instanceof HTMLInputElement || e.target instanceof HTMLTextAreaElement) {
      return
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∂–∏–º –º–æ–¥–µ—Ä–∞—Ü–∏–∏
    const isModerationMode = props.moderationMode || page.url.includes('/moderation')
    if (!isModerationMode) {
      return
    }

    // –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
    switch (e.key.toLowerCase()) {
      case 'a': // Approve
        e.preventDefault()
        const approveBtn = document.querySelector('[data-action="approve"]') as HTMLElement
        if (approveBtn) {
          approveBtn.click()
          addToast('‚úÖ –û–±—ä—è–≤–ª–µ–Ω–∏–µ –æ–¥–æ–±—Ä–µ–Ω–æ (–∫–ª–∞–≤–∏—à–∞ A)', 'success')
        }
        break

      case 'r': // Reject
        e.preventDefault()
        const rejectBtn = document.querySelector('[data-action="reject"]') as HTMLElement
        if (rejectBtn) {
          rejectBtn.click()
          addToast('‚ùå –û–±—ä—è–≤–ª–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ (–∫–ª–∞–≤–∏—à–∞ R)', 'error')
        }
        break

      case 'n': // Next
        e.preventDefault()
        const nextItem = document.querySelector('[data-action="next"]') as HTMLElement
        if (nextItem) {
          nextItem.click()
        } else {
          // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –æ–±—ä—è–≤–ª–µ–Ω–∏—é
          const currentIndex = props.profiles?.findIndex(p => p.id === (window as any).currentItemId) ?? -1
          if (currentIndex >= 0 && currentIndex < (props.profiles?.length ?? 0) - 1) {
            const nextProfile = props.profiles?.[currentIndex + 1]
            if (nextProfile) {
              ;(window as any).currentItemId = nextProfile.id
              addToast(`‚û°Ô∏è –ü–µ—Ä–µ—Ö–æ–¥ –∫ –æ–±—ä—è–≤–ª–µ–Ω–∏—é #${nextProfile.id} (–∫–ª–∞–≤–∏—à–∞ N)`, 'info')
            }
          }
        }
        break

      case 'escape': // –ó–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
        e.preventDefault()
        const modal = document.querySelector('[data-modal="active"]') as HTMLElement
        if (modal) {
          const closeBtn = modal.querySelector('[data-action="close"]') as HTMLElement
          if (closeBtn) {
            closeBtn.click()
          }
        }
        break

      case '?': // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É
        e.preventDefault()
        addToast('‚å®Ô∏è –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏: A - –æ–¥–æ–±—Ä–∏—Ç—å, R - –æ—Ç–∫–ª–æ–Ω–∏—Ç—å, N - —Å–ª–µ–¥—É—é—â–µ–µ, ESC - –∑–∞–∫—Ä—ã—Ç—å', 'info', 8000)
        break
    }
  }

  window.addEventListener('keydown', handleKeyPress)

  // Cleanup –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
  onUnmounted(() => {
    window.removeEventListener('keydown', handleKeyPress)
  })
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥–æ—Ä—è—á–∏—Ö –∫–ª–∞–≤–∏—à –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
onMounted(() => {
  setupHotkeys()

  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É –∞–¥–º–∏–Ω—É –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ
  if (user.value.role === 'admin' && props.moderationMode) {
    setTimeout(() => {
      addToast('üí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –º–æ–¥–µ—Ä–∞—Ü–∏–∏. –ù–∞–∂–º–∏—Ç–µ ? –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏', 'info', 7000)
    }, 2000)
  }
})
</script>

<style scoped>
/* –°—Ç–∏–ª–∏ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞ */
.dashboard-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 1.5rem;
}

/* –ê–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
.stat-card {
  transition: transform 0.2s ease-in-out;
}

.stat-card:hover {
  transform: translateY(-2px);
}
</style>