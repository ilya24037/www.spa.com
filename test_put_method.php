<?php

echo "🔍 ТЕСТ ВОЗВРАТА К PUT МЕТОДУ\n";
echo "=============================\n\n";

echo "✅ ВОЗВРАЩЕНЫ ОРИГИНАЛЬНЫЕ НАСТРОЙКИ:\n";
echo "1. method: isUpdate ? 'put' : 'post'\n";
echo "2. Content-Type: multipart/form-data\n";
echo "3. URL: /draft/85 (для редактирования)\n";
echo "4. Сохранен CSRF токен\n";
echo "5. Сохранены поля в fillable\n\n";

echo "🎯 ГИПОТЕЗА:\n";
echo "Раньше работало с PUT запросами через оригинальный маршрут.\n";
echo "Проблема возникла когда перешли на POST для FormData.\n\n";

echo "📋 ПЛАН ТЕСТИРОВАНИЯ:\n";
echo "1. Откройте http://spa.test/ads/85/edit\n";
echo "2. Заполните простые поля:\n";
echo "   - Возраст: 25\n";
echo "   - Телефон: 79001234567\n";
echo "   - Адрес: Тест адрес\n";
echo "3. Нажмите 'Сохранить черновик'\n";
echo "4. Смотрите консоль браузера\n\n";

echo "🔍 ОЖИДАЕМЫЙ РЕЗУЛЬТАТ:\n";
echo "Консоль должна показать:\n";
echo "- saveDraft ОТПРАВКА: {method: 'put', url: '/draft/85'}\n";
echo "- saveDraft ОТВЕТ получен: {success: true, message: '...'}\n";
echo "- БЕЗ ошибок 'Не удалось загрузить XHR'\n\n";

echo "✅ ЕСЛИ РАБОТАЕТ:\n";
echo "1. Черновик сохраняется полностью\n";
echo "2. Все поля (включая age, phone, address) должны сохраниться\n";
echo "3. Проблема 'часть секций сохраняет поля часть нет' РЕШЕНА!\n\n";

echo "❌ ЕСЛИ НЕ РАБОТАЕТ:\n";
echo "Нужна дополнительная диагностика инфраструктуры\n\n";

echo "🚀 КОМАНДА ПРОВЕРКИ ПОСЛЕ ТЕСТА:\n";
echo 'php diagnose_sections.php' . "\n";
echo "Должны появиться заполненные поля вместо NULL\n";