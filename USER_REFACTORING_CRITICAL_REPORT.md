# üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–¶–ï–ù–ö–ê: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ User –¥–æ–º–µ–Ω–∞

## –û—Ü–µ–Ω–∫–∞: 6/10 ‚Üí 9/10 –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –ù–ê–ô–î–ï–ù–ù–´–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´:

#### ‚ùå 1. –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Ä–æ–ª–µ–π
```php
// UserRole enum: –µ—Å—Ç—å MODERATOR
// UserRepository: —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞–º  
// User –º–æ–¥–µ–ª—å: –ù–ï–¢ –º–µ—Ç–æ–¥–∞ isModerator()!
```
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `isModerator()` –≤ User –º–æ–¥–µ–ª—å

#### ‚ùå 2. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
```php
// –í HasRoles —Ç—Ä–µ–π—Ç–µ
public function hasPermission(string $permission): bool {
    $permissions = [...]; // –•–∞—Ä–¥–∫–æ–¥
}

// –í UserRole enum
public function hasPermission(string $permission): bool {
    return in_array($permission, $this->getPermissions());
}
```
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** ‚úÖ HasRoles —Ç–µ–ø–µ—Ä—å –¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç –ª–æ–≥–∏–∫—É –≤ UserRole enum

#### ‚ùå 3. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏
```php
public function getProfile(): UserProfile {
    return $this->profile ?: $this->profile()->create([...]);
}
```
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è, –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

#### ‚ùå 4. Hardcoded –∑–Ω–∞—á–µ–Ω–∏—è –∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** ‚úÖ –í—ã–Ω–µ—Å–µ–Ω—ã –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –º–µ—Ç–æ–¥—ã, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

### –†–ï–ó–£–õ–¨–¢–ê–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô:

#### ‚úÖ User.php (122 —Å—Ç—Ä–æ–∫–∏)
```php
class User extends Authenticatable implements MustVerifyEmail
{
    use HasApiTokens, HasFactory, Notifiable;
    use HasRoles, HasProfile;
    
    // + –î–æ–±–∞–≤–ª–µ–Ω isModerator()
    // + –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
}
```

#### ‚úÖ HasRoles.php (43 —Å—Ç—Ä–æ–∫–∏)
```php
trait HasRoles
{
    public function hasRole(string $role): bool
    public function hasAnyRole(array $roles): bool
    
    // –î–µ–ª–µ–≥–∏—Ä—É–µ—Ç –≤ UserRole enum - –ù–ï–¢ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
    public function hasPermission(string $permission): bool {
        return $this->role->hasPermission($permission);
    }
    
    public function changeRole(UserRole $newRole): bool
}
```

#### ‚úÖ HasProfile.php (98 —Å—Ç—Ä–æ–∫)
```php
trait HasProfile
{
    // + –£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–µ–π
    // + –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö
    // + –í—ã–Ω–µ—Å–µ–Ω—ã –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –º–µ—Ç–æ–¥—ã
    
    public function getProfile(): UserProfile
    public function getSettings(): UserSettings
    public function hasCompleteProfile(): bool
    public function getFullName(): string
    public function getAvatarUrl(): string
}
```

### –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ï –†–ï–®–ï–ù–ò–Ø:

1. **–õ–æ–≥–∏–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π** - –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –≤ UserRole enum
2. **–ú–µ—Ç–æ–¥—ã —Ä–æ–ª–µ–π** - –æ—Å—Ç–∞–ª–∏—Å—å –≤ User –º–æ–¥–µ–ª–∏ (Laravel convention)
3. **–¢—Ä–µ–π—Ç—ã** - —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –ø–æ–¥ User –¥–æ–º–µ–Ω
4. **–°–æ–∑–¥–∞–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π** - —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º–∏ –æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö

### –§–ò–ù–ê–õ–¨–ù–ê–Ø –°–¢–†–£–ö–¢–£–†–ê:

```
app/Domain/User/
‚îú‚îÄ‚îÄ Models/
‚îÇ   ‚îú‚îÄ‚îÄ User.php (122 —Å—Ç—Ä–æ–∫–∏) ‚úÖ
‚îÇ   ‚îú‚îÄ‚îÄ UserProfile.php (57 —Å—Ç—Ä–æ–∫) ‚úÖ  
‚îÇ   ‚îî‚îÄ‚îÄ UserSettings.php (52 —Å—Ç—Ä–æ–∫–∏) ‚úÖ
‚îú‚îÄ‚îÄ Traits/
‚îÇ   ‚îú‚îÄ‚îÄ HasRoles.php (43 —Å—Ç—Ä–æ–∫–∏) ‚úÖ
‚îÇ   ‚îî‚îÄ‚îÄ HasProfile.php (98 —Å—Ç—Ä–æ–∫) ‚úÖ
‚îú‚îÄ‚îÄ Services/, Repositories/, DTOs/, Actions/ ‚úÖ
```

### –û–¶–ï–ù–ö–ê –ö–ê–ß–ï–°–¢–í–ê:

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π |
|----------|---------------|-------------------|
| DDD —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ | ‚úÖ 9/10 | ‚úÖ 9/10 |
| –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å | ‚ùå 3/10 | ‚úÖ 9/10 |
| –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è | ‚ùå 4/10 | ‚úÖ 9/10 |
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π | ‚ùå 5/10 | ‚úÖ 8/10 |
| –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ | ‚úÖ 7/10 | ‚úÖ 9/10 |

### –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –î–õ–Ø PRODUCTION:

1. **–î–æ–±–∞–≤–∏—Ç—å unit —Ç–µ—Å—Ç—ã** –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤ —Ç—Ä–µ–π—Ç–æ–≤
2. **–†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Model Observers** –¥–ª—è –∞–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–π
3. **–î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é** –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥
4. **–°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é** –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –ø—Ä–æ—Ñ–∏–ª–µ–π

## ‚úÖ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï:

–ü–æ—Å–ª–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ User –¥–æ–º–µ–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç **–≤—ã—Å–æ–∫–∏–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º DDD –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã** –∏ –≥–æ—Ç–æ–≤ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.