"use strict";(self.webpackChunkDetached_pdp=self.webpackChunkDetached_pdp||[]).push([["pdp-all-add-to-favorite"],{"4bc86":(t,e,o)=>{o.a(t,async(t,r)=>{try{var h=o("16477"),n=o("79a44"),c=o("ac556"),l=o("eb583"),d=o("a8449"),v=o("69aed"),m=o("86e62"),f=o("9fd08"),T=o("50be1"),w=o("0e79c"),C=o("0af63"),y=o("5462a"),x=o("fd85c"),S=o("46ff0"),A=o("70b18"),F=o("b359e"),_=o("8a48c"),I=o("a6896"),B=o("abb9e"),j=o.n(B),O=o("42b36"),E=o("d0e6b"),P=o("5ac29"),W=o("d754e"),H=o("7d50c"),k=t([c,l,d,T,w,x]);[c,l,d,T,w,x]=k.then?(await k)():k;var{ServiceWorkerMixin:D,FavoriteIcon16:M,FavoriteIcon24:L}=(V={},N={methods:{cacheCartPageSW(){var t=this.$composerStore.state._get("experimentsConfig.enableSWCaching",!1),e=this.$composerStore.state._get("experimentsConfig.prerenderCartPageSW",!1),o=this.$composerStore.state._get("layoutTrackingInfo.pageType");"cart"!==o&&"checkout"!==o&&t&&e&&(0,v.sendMessageToSW)({action:"CACHE_CART_PAGE"})},cacheHomePageSW(){var t=this.$composerStore.state._get("experimentsConfig.enableSWCaching",!1),e=this.$composerStore.state._get("experimentsConfig.prerenderHomePageSW",!1);t&&e&&(0,v.sendMessageToSW)({action:"CACHE_HOME_PAGE"})}}},G={functional:!0,name:"icSHeart",meta:{width:16,height:16,viewBox:"0 0 16 16"},render:(t,a)=>t("svg",Object.assign(Object.assign({},a.data),{},{attrs:Object.assign({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16"},a.data.attrs),domProps:{innerHTML:'<path fill="currentColor" d="M16 6.522C16 3.957 14.052 2 11.5 2c-1.432 0-2.665.799-3.5 1.926C7.165 2.799 5.932 2 4.5 2 1.948 2 0 3.957 0 6.522c0 2.457 1.66 4.415 3.241 5.743 1.617 1.358 3.387 2.258 4.062 2.577.444.21.95.21 1.394 0 .675-.32 2.445-1.219 4.062-2.577C14.339 10.937 16 8.979 16 6.522m-7.719 6.287a.55.55 0 0 1-.562 0c-.763-.39-2.035-1.11-3.195-2.086C3.06 9.494 2 8.051 2 6.522 2 5.067 3.052 4.01 4.5 4.01c.802 0 1.416.473 1.888 1.105.26.348.475.736.633 1.142.161.41.482.767.979.767s.818-.356.979-.767c.158-.406.373-.794.634-1.142.471-.632 1.085-1.105 1.887-1.105 1.448 0 2.5 1.057 2.5 2.512 0 1.53-1.06 2.972-2.524 4.201-1.16.975-2.432 1.695-3.195 2.086"/>'}}))},Z={functional:!0,name:"icMHeart",meta:{width:24,height:24,viewBox:"0 0 24 24"},render:(t,a)=>t("svg",Object.assign(Object.assign({},a.data),{},{attrs:Object.assign({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24"},a.data.attrs),domProps:{innerHTML:'<path fill="currentColor" d="M7 5a4 4 0 0 0-4 4c0 3.552 2.218 6.296 4.621 8.22A21.5 21.5 0 0 0 12 19.91a21.6 21.6 0 0 0 4.377-2.69C18.78 15.294 21 12.551 21 9a4 4 0 0 0-4-4c-1.957 0-3.652 1.396-4.02 3.2a1 1 0 0 1-1.96 0C10.652 6.396 8.957 5 7 5m5 17c-.316-.02-.56-.147-.848-.278a23.5 23.5 0 0 1-4.781-2.942C3.777 16.705 1 13.449 1 9a6 6 0 0 1 6-6 6.18 6.18 0 0 1 5 2.568A6.18 6.18 0 0 1 17 3a6 6 0 0 1 6 6c0 4.448-2.78 7.705-5.375 9.78a23.6 23.6 0 0 1-4.78 2.942c-.543.249-.732.278-.845.278"/>'}}))},V.ServiceWorkerMixin=N,V.FavoriteIcon16=G,V.FavoriteIcon24=Z,V),R={width:56,height:44};e.Z=j().extend({name:"WidgetAddToFavorite",mixins:[_.ZP,F.Z,A.Z,S.Z,O.Z,f.CartGlobalStoreMixin,D,E.Z,C.DefaultAtomActionsMixin],data:()=>({localLoading:!1,isShownFavoriteTooltip:!1,remainFavoriteTooltipTimeout:0,tooltipContent:{},timer:null,tooltipWidth:240,TOOLTIP_IMAGE_SIZE:R}),components:{AtomWebButton:c.AtomWebButton,DsTooltip:l.DsTooltip,AtomButton:c.AtomSmallButton,DsButtonAtom:w.AtomDsButton,FavoriteTooltip:x.Z},computed:{quantity(){var t=this.itemsHash[this.sku];return t?t.quantity:0},loading(){return this.localLoading||this.showAsyncLoader},sku(){return this.widgetState.sku||""},isInFavorite(){return this.widgetState.isInFavorite||!1},isLoggedIn(){return this.widgetState.isLoggedIn||!1},buttonText(){var t=Boolean(this.btnText&&this.btnTextActive);return this.isDefaultTheme&&t?this.isInFavorite?this.btnTextActive:this.btnText:""},btnTheme(){return this.isApparelTheme&&this.widgetState.isPremiumCard?"secondaryAlt":this.isApparelTheme?"secondary":"inline"},btnIconColor(){return!this.isInFavorite&&this.isApparelTheme&&this.widgetState.isPremiumCard?"graphicPrimary":this.isInFavorite?"bgAccentPrimary":""},btnAttrs(){return{theme:this.btnTheme,size:this.isApparelTheme?"xxl":"m",loading:this.loading,disabled:this.loading,text:this.buttonText,icon:this.isDefaultTheme&&!this.$isMobile?M:L,iconColor:this.btnIconColor,"aria-label":this.isInFavorite?this.widgetState.lexemes&&this.widgetState.lexemes.ariaLabelClearText||"":this.widgetState.lexemes&&this.widgetState.lexemes.ariaLabelAddText||""}},isShownFavoritePopover(){return this.isShownFavoriteTooltip&&this.isViewport},mustShowFavoriteTooltip(){return this.widgetState.isShowFavoriteTooltip&&this.favoriteTooltipIsShow},sessionFavoriteTooltipName(){return`favorite-tooltip-${this.sku}-is-show`},btnText(){return(0,H.W)(this.stateParams.btnText,"")},btnTextActive(){return(0,H.W)(this.stateParams.btnTextActive,"")},favoriteTooltipIsShow(){return(0,H.W)(this.stateParams.favoriteTooltipIsShow,!1)},favoriteTooltipTitle(){return(0,H.W)(this.stateParams.favoriteTooltipTitle,"")},favoriteTooltipText(){return(0,H.W)(this.stateParams.favoriteTooltipText,"")},favoriteTooltipSrcImg(){return(0,H.W)(this.stateParams.favoriteTooltipSrcImg,"")},favoriteTooltipTimeToShow(){return(0,H.W)(this.stateParams.favoriteTooltipTimeToShow,0)},favoriteTooltipTimeForShow(){return(0,H.W)(this.stateParams.favoriteTooltipTimeForShow,0)}},methods:{async updateState(){this.loading=!0;try{await this.fetchAsyncState()}catch(t){this.onActionError(t,P.C.ERROR_LOAD_STATE_WIDGET_ADD_TO_CART)}this.loading=!1},async onFavoriteClick(){(0,v.sendMessageToSW)({action:"CLEAR_SW_CACHE",cacheNames:[m.ECacheNames.CART,m.ECacheNames.HOME_PAGE]}),this.localLoading=!0;var t=this.isInFavorite?"remove":"add",e=this.isInFavorite?h.EActionTypes.UNFAVORITE_ACTION:h.EActionTypes.FAVORITE_ACTION;try{var o=await n.registry.use(d.FavoritesActions).dispatchHandleFavorite(this.sku,t);this.sendAnalytics(e,"products.main"),await this.fetchAsyncState();var{notification:r,oldNotification:c}=o||{};if(r)if(r.favoriteAddTooltip){var{favoriteAddTooltip:l}=r;l&&(this.tooltipContent=l,this.tooltipWidth=196,this.$refs.popover.show(),l.seconds&&this.closeOnTimer(l.seconds))}else r.notificationBar?this.$registry.use(y.NotificationsActions).createNewNotification(r.notificationBar):r.notificationWithIcon&&this.$registry.use(y.NotificationsActions).createNewNotificationAtomDeprecated(Object.assign({},r));else c&&(c.button&&c.button.link&&(c.button.action=()=>this.composerRouter.redirect(c.button.link)),n.registry.use(y.NotificationsActions).createNewNotificationDeprecated(Object.assign({},c)));this.cacheCartPageSW(),this.cacheHomePageSW()}catch(t){this.$logger.error({exception:t,message:P.C.ERROR_ON_FAVORITE_CLICK})}this.localLoading=!1},closeOnTimer(t){this.timer=setTimeout(()=>{this.$refs.popover.hide(),this.tooltipWidth=240},1e3*t)},processShowTooltip(){this.timerFavoriteTooltipCreatedAt=Date.now(),this.favoriteTooltipTimerId=setTimeout(this.showingTooltip,1e3*this.remainFavoriteTooltipTimeout)},showingTooltip(){this.changeFavoriteTooltipSessionInfo(I.L.SHOW),this.isViewport&&this.sendAnalytics(h.EActionTypes.VIEW_ACTION,"uis.favoriteTooltip"),setTimeout(()=>{this.changeFavoriteTooltipSessionInfo(I.L.CLOSE)},1e3*this.favoriteTooltipTimeForShow)},rememberRemainAndClearTimer(){this.remainFavoriteTooltipTimeout-=(Date.now()-this.timerFavoriteTooltipCreatedAt)/1e3,clearTimeout(this.favoriteTooltipTimerId)},changeFavoriteTooltipSessionInfo(t){sessionStorage.setItem(this.sessionFavoriteTooltipName,t),this.removeVisibilityChange(),t===I.L.CLOSE?(this.dispatchFavoriteTooltipShowRxEvent(!1),this.removeIntersectionObserver(),this.removeFavoriteTooltipRxObserver()):t===I.L.SHOW&&this.dispatchFavoriteTooltipShowRxEvent(!0)},addFavoriteTooltipRxObserver(){this.favoriteTooltipObserver=n.registry.use(W.o).listen("FavoriteTooltipShow",({payload:t})=>{this.isShownFavoriteTooltip=t.show})},dispatchFavoriteTooltipShowRxEvent(t){n.registry.use(W.o).emit("FavoriteTooltipShow",{show:t})},removeFavoriteTooltipRxObserver(){this.favoriteTooltipObserver&&this.favoriteTooltipObserver.unsubscribe()}},created(){this.favEventsSubscription=n.registry.use(d.FavoritesEvents).$favEventsById(this.sku).subscribe({next:t=>{this.setWidgetStateValue("isInFavorite","add"===t.payload.type)}}),this.TooltipPopoverInfo=I.L},mounted(){var t=sessionStorage.getItem(this.sessionFavoriteTooltipName)||"";this.subsActionsSubscription=n.registry.use(T.SubscriptionsActions).listen(["SUBSCRIBE_ITEM_CHANGE"],this.updateState),this.mustShowFavoriteTooltip&&!t&&(this.addIntersectionObserver(this.$el),this.addVisibilityChange(),this.addFavoriteTooltipRxObserver(),this.remainFavoriteTooltipTimeout=this.favoriteTooltipTimeToShow)},beforeDestroy(){this.favEventsSubscription&&this.favEventsSubscription.unsubscribe(),this.removeVisibilityChange(),this.removeIntersectionObserver(),this.removeFavoriteTooltipRxObserver(),this.subsActionsSubscription&&this.subsActionsSubscription.unsubscribe()},watch:{quantity:{immediate:!0,handler(){this.quantity>0&&this.mustShowFavoriteTooltip&&this.changeFavoriteTooltipSessionInfo(I.L.CLOSE)}},isInFavorite:{immediate:!0,handler(){this.isInFavorite&&this.mustShowFavoriteTooltip&&this.changeFavoriteTooltipSessionInfo(I.L.CLOSE)}},isVisibility:{immediate:!0,handler(){this.isVisibility?this.processShowTooltip():this.timerFavoriteTooltipCreatedAt&&this.rememberRemainAndClearTimer()}}}}),r()}catch(t){r(t)}var V,N,G,Z})},"70b18":(t,e)=>{e.Z={data:()=>({isViewport:!1}),methods:{addIntersectionObserver(t){this.removeIntersectionObserver(),t&&this.onIntersectionObserver(t)},onIntersectionObserver(t){this.intersectionObserver=new IntersectionObserver(t=>{this.isViewport=t[0].isIntersecting}),this.intersectionObserver.observe(t)},removeIntersectionObserver(){this.intersectionObserver&&this.intersectionObserver.disconnect()}},beforeDestroy(){this.removeIntersectionObserver()}}},"46ff0":(t,e)=>{e.Z={data:()=>({isVisibility:!1}),methods:{onVisibilityChange(){this.isVisibility="visible"===document.visibilityState},addVisibilityChange(){this.removeVisibilityChange(),this.onVisibilityChange(),document.addEventListener("visibilitychange",this.onVisibilityChange)},removeVisibilityChange(){document.removeEventListener("visibilitychange",this.onVisibilityChange)}},beforeDestroy(){this.removeVisibilityChange()}}},d754e:(t,e,o)=>{o.d(e,{o:()=>h});var r=o("69aed");class h extends r.EventBus{}h.__serviceName="EventBus_PdpEvents"},a6896:(t,e,o)=>{o.d(e,{L:()=>r});var r=function(t){return t.SHOW="show",t.CLOSE="close",t}({})},"285cc":(t,e,o)=>{o.a(t,async(t,r)=>{try{o.r(e);var h=o("fae42"),n=o("4affa"),c=o("20345"),l=o("695d8"),d=o.n(l),v=t([n]);function m(t){this.$style=c.Z.locals||c.Z}n=(v.then?(await v)():v)[0];var component=d()(n.Z,h.s,h.x,!1,m,null,null);e.default=component.exports,r()}catch(f){r(f)}})},b6ecc:(t,e,o)=>{o.d(e,{Z:()=>r});var r={tooltipPopover:"jp7_27",leftContent:"j7p_27",title:"pj7_27",text:"p7j_27",img:"jp8_27"}},20345:(t,e,o)=>{o.d(e,{Z:()=>r});var r={root:"jq6_27",popover:"j6q_27",tooltipSubtitle:"qj6_27",tooltipTitle:"q6j_27",tooltipButtonWrapper:"jq7_27"}},"4affa":(t,e,o)=>{o.a(t,async(t,r)=>{try{var h=o("4bc86"),n=t([h]);h=(n.then?(await n)():n)[0],e.Z=h.Z,r()}catch(t){r(t)}})},fae42:(t,e,o)=>{o.d(e,{s:()=>r,x:()=>h});var r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.showWidget?o("DsTooltip",{ref:"popover",attrs:{"min-width":t.tooltipWidth+"px","max-width":t.tooltipWidth+"px",trigger:"manual","force-show":t.isShownFavoritePopover},on:{clickButtonClose:function(e){return t.changeFavoriteTooltipSessionInfo(t.TooltipPopoverInfo.CLOSE)}},scopedSlots:t._u([{key:"popover",fn:function(){return[t.isShownFavoritePopover?o("FavoriteTooltip",{attrs:{title:t.favoriteTooltipTitle,text:t.favoriteTooltipText,"src-img":t.favoriteTooltipSrcImg,size:t.TOOLTIP_IMAGE_SIZE,"qa-id-prefix":"favorite"},on:{closeTooltipPopover:function(e){return t.changeFavoriteTooltipSessionInfo(t.TooltipPopoverInfo.CLOSE)}}}):o("div",{class:[t.$style.tooltip]},[t.tooltipContent.title?o("div",{class:["tsBodyControl400Small",t.$style.tooltipTitle]},[t._v("\n        "+t._s(t.tooltipContent.title)+"\n      ")]):t._e(),t._v(" "),t.tooltipContent.subTitle?o("div",{class:["tsBody400Small",t.$style.tooltipSubtitle]},[t._v("\n        "+t._s(t.tooltipContent.subTitle)+"\n      ")]):t._e(),t._v(" "),o("div",{class:[t.$style.tooltipButtonWrapper]},[t.tooltipContent.button&&!t.tooltipContent.submitButton?o("AtomButton",t._b({attrs:{fill:!0},on:{click:t.onAtomAction}},"AtomButton",t.tooltipContent.button,!1)):t._e(),t._v(" "),t.tooltipContent.submitButton?o("DsButtonAtom",t._b({attrs:{fill:!0},on:{click:t.onAtomAction}},"DsButtonAtom",t.tooltipContent.submitButton,!1)):t._e()],1)])]},proxy:!0}],null,!1,284780477)},[o("AtomWebButton",t._b({directives:[{name:"qa",rawName:"v-qa:id",value:"pdp-favorite-button",expression:"'pdp-favorite-button'",arg:"id"}],class:t.$style.root,on:{click:t.onFavoriteClick}},"AtomWebButton",t.btnAttrs,!1))],1):t._e()},h=[]}}]);