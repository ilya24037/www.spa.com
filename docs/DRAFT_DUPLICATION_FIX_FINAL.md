# üìã –û–¢–ß–ï–¢: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤

## üêõ –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ü—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —á–µ—Ä–Ω–æ–≤–∏–∫–∞ –∏ –Ω–∞–∂–∞—Ç–∏–∏ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫" —Å–æ–∑–¥–∞–≤–∞–ª—Å—è –Ω–æ–≤—ã–π —á–µ—Ä–Ω–æ–≤–∏–∫ –≤–º–µ—Å—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ
- –í —Å–ø–∏—Å–∫–µ –Ω–∞–∫–∞–ø–ª–∏–≤–∞–ª–∏—Å—å –¥—É–±–ª–∏–∫–∞—Ç—ã —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤

**–ö–æ—Ä–Ω–µ–≤—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. **AdController::edit()** - –¥–ª—è —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è `DraftService::prepareForDisplay()`, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–ª –º–∞—Å—Å–∏–≤ –±–µ–∑ –≥–∞—Ä–∞–Ω—Ç–∏–∏ –Ω–∞–ª–∏—á–∏—è ID
2. **DraftService::saveOrUpdate()** - –ø—Ä–æ–≤–µ—Ä–∫–∞ `user_id` –º–æ–≥–ª–∞ –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
3. **Frontend** - ID –Ω–µ –≤—Å–µ–≥–¥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞–ª—Å—è –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. AdController::edit() - –ì–∞—Ä–∞–Ω—Ç–∏—è –ø–µ—Ä–µ–¥–∞—á–∏ ID
**–§–∞–π–ª:** `app/Application/Http/Controllers/Ad/AdController.php`

```php
// –ë–´–õ–û: ID –º–æ–≥ –ø–æ—Ç–µ—Ä—è—Ç—å—Å—è –ø—Ä–∏ prepareForDisplay
$preparedData = $draftService->prepareForDisplay($ad);

// –°–¢–ê–õ–û: –Ø–≤–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º ID –ø–æ—Å–ª–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö
$preparedData = $draftService->prepareForDisplay($ad);
$preparedData['id'] = (int) $ad->id;
```

### 2. DraftService::saveOrUpdate() - –£–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
**–§–∞–π–ª:** `app/Domain/Ad/Services/DraftService.php`

```php
// –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ auth()->id()
if (auth()->check() && auth()->id() == $adWithoutUserCheck->user_id) {
    Log::info('DraftService::saveOrUpdate - updating using auth()->id() match');
    $adWithoutUserCheck->update($data);
    return $adWithoutUserCheck;
}
```

### 3. DraftService::prepareForDisplay() - –ì–∞—Ä–∞–Ω—Ç–∏—è –Ω–∞–ª–∏—á–∏—è ID
**–§–∞–π–ª:** `app/Domain/Ad/Services/DraftService.php`

```php
public function prepareForDisplay(Ad $ad): array
{
    $data = $ad->toArray();
    
    // –í–ê–ñ–ù–û: –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ ID –≤—Å–µ–≥–¥–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏ –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø
    $data['id'] = (int) $ad->id;
    
    // ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞
}
```

### 4. –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
–í–æ –≤—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ—á–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –ª–æ–≥–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–±–ª–µ–º:
- AdController::edit() - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
- DraftService::saveOrUpdate() - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤ –ø–æ–∏—Å–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- DraftService::prepareForDisplay() - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```
üîç –¢–ï–°–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –î–£–ë–õ–ò–†–û–í–ê–ù–ò–Ø –ß–ï–†–ù–û–í–ò–ö–û–í
=============================================================

‚úÖ –¢–ï–°–¢ 1: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —á–µ—Ä–Ω–æ–≤–∏–∫–∞ - –ü–†–û–ô–î–ï–ù
‚úÖ –¢–ï–°–¢ 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —á–µ—Ä–Ω–æ–≤–∏–∫–∞ - –ü–†–û–ô–î–ï–ù  
‚úÖ –¢–ï–°–¢ 3: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è - –ü–†–û–ô–î–ï–ù
‚úÖ –¢–ï–°–¢ 4: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è Edit.vue - –ü–†–û–ô–î–ï–ù

üéØ –ò–¢–û–ì–û–í–ê–Ø –ü–†–û–í–ï–†–ö–ê:
‚úÖ ID –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
‚úÖ User ID –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

üéâ –í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´ –£–°–ü–ï–®–ù–û!
```

## üìä –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- –ü—Ä–∏ –∫–∞–∂–¥–æ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —á–µ—Ä–Ω–æ–≤–∏–∫–∞ —Å–æ–∑–¥–∞–≤–∞–ª—Å—è –Ω–æ–≤—ã–π
- –°–ø–∏—Å–æ–∫ —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤ –∑–∞—Å–æ—Ä—è–ª—Å—è –¥—É–±–ª–∏–∫–∞—Ç–∞–º–∏
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Ç–µ—Ä—è–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã—Ö —á–µ—Ä–Ω–æ–≤–∏–∫–∞—Ö

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- –ß–µ—Ä–Ω–æ–≤–∏–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
- ID —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ –≤—Å–µ—Ö —ç—Ç–∞–ø–∞—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –î—É–±–ª–∏–∫–∞—Ç—ã –±–æ–ª—å—à–µ –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–î–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –ª–æ–≥–∏ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö –º–µ—Å—Ç–∞—Ö:
- `AdController::edit` - –ª–æ–≥–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–Ω–æ–≤–∏–∫–∞
- `DraftService::saveOrUpdate` - –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ —ç—Ç–∞–ø—ã –ø–æ–∏—Å–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- `DraftService::prepareForDisplay` - –ª–æ–≥–∏—Ä—É–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –ø–æ –∫–ª—é—á–∞–º:
- `AdController::edit - draft data`
- `DraftService::saveOrUpdate`
- `DraftService::prepareForDisplay`

## üìù –í—ã–≤–æ–¥—ã

–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤—ã–∑–≤–∞–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å–æ–º —Ñ–∞–∫—Ç–æ—Ä–æ–≤:
1. –ù–µ–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ ID –º–µ–∂–¥—É backend –∏ frontend
2. –ò–∑–ª–∏—à–Ω–µ —Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ user_id –≤ DraftService
3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≥–∞—Ä–∞–Ω—Ç–∏–π –Ω–∞–ª–∏—á–∏—è ID –≤ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, –¥–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞—â–∏—Ç–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã.