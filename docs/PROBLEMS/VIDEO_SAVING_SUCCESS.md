# üé• –£–°–ü–ï–®–ù–û–ï –†–ï–®–ï–ù–ò–ï: –í–∏–¥–µ–æ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

## üìã –ü–†–û–ë–õ–ï–ú–ê
–í–∏–¥–µ–æ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π, —Ö–æ—Ç—è –≤ —á–µ—Ä–Ω–æ–≤–∏–∫–∞—Ö —Ä–∞–±–æ—Ç–∞–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

## üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê
1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ**: `AdController::store` –∏ `AdController::update` –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∏ –≤–∏–¥–µ–æ
2. **–î–≤–æ–π–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ —Å–µ—Ä–≤–∏—Å–µ**: `DraftService` –ø—ã—Ç–∞–ª—Å—è –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤–∏–¥–µ–æ –∫–∞–∫ JSON –ø–æ–ª–µ
3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–µ—Ç–æ–¥–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏**: –Ω–µ –±—ã–ª–æ `processVideoFromRequest` –∏ `saveBase64Video`

## ‚úÖ –†–ï–®–ï–ù–ò–ï

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ –≤ AdController
**–§–∞–π–ª**: `app/Application/Http/Controllers/Ad/AdController.php`

```php
// –í –º–µ—Ç–æ–¥–µ store
$processedPhotos = $this->processPhotosFromRequest($request);
$processedVideo = $this->processVideoFromRequest($request);

$data = array_merge(
    $request->validated(),
    [
        'user_id' => Auth::id(),
        'status' => 'active',
        'is_published' => false,
        'photos' => $processedPhotos,
        'video' => $processedVideo // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –≤–∏–¥–µ–æ
    ]
);

// –í –º–µ—Ç–æ–¥–µ update
$processedPhotos = $this->processPhotosFromRequest($request);
$processedVideo = $this->processVideoFromRequest($request);

$data = array_merge(
    $request->validated(),
    [
        'photos' => $processedPhotos,
        'video' => $processedVideo // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –≤–∏–¥–µ–æ
    ]
);
```

### 2. –°–æ–∑–¥–∞–Ω –º–µ—Ç–æ–¥ processVideoFromRequest
```php
private function processVideoFromRequest(Request $request, int $maxVideos = 10): array
{
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ video –∫–∞–∫ JSON —Å—Ç—Ä–æ–∫–∏ –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π video[index]
    // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∞–π–ª–æ–≤, base64 –∏ URL
    // –õ–∏–º–∏—Ç: 100MB –¥–ª—è –≤–∏–¥–µ–æ
    // –§–æ—Ä–º–∞—Ç—ã: MP4, AVI, MOV, WMV, FLV, WebM, MKV
}
```

### 3. –°–æ–∑–¥–∞–Ω –º–µ—Ç–æ–¥ saveBase64Video
```php
private function saveBase64Video(string $base64Data): ?string
{
    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ base64 –≤–∏–¥–µ–æ –∫–∞–∫ —Ñ–∞–π–ª–æ–≤
    // –ü–∞–ø–∫–∞: storage/app/public/videos/{user_id}/
    // URL: /storage/videos/{user_id}/filename.ext
}
```

### 4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω DraftService
**–§–∞–π–ª**: `app/Domain/Ad/Services/DraftService.php`

```php
// –ò–°–ö–õ–Æ–ß–ê–ï–ú photos –∏ video - –æ–Ω–∏ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –≤ AdController
$jsonFields = ['clients', 'service_provider', 'features', 'services', 'schedule',
               'geo', 'custom_travel_areas', 'prices', 'faq'];

// –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è video
if (isset($data['video']) && is_array($data['video'])) {
    // –í–∏–¥–µ–æ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –≤ AdController::processVideoFromRequest
    Log::info('video —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã', [
        'video_count' => count($data['video']),
        'video_sample' => array_slice($data['video'], 0, 2)
    ]);
}
```

## üéØ –†–ï–ó–£–õ–¨–¢–ê–¢
- ‚úÖ **–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π** —Å –≤–∏–¥–µ–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏–π** —Å –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –≤–∏–¥–µ–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –≤–∏–¥–µ–æ**: —Ñ–∞–π–ª—ã, base64, URL
- ‚úÖ **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —á–µ—Ä–Ω–æ–≤–∏–∫–∞—Ö –∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ–±—ä—è–≤–ª–µ–Ω–∏—è—Ö** —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–∏–¥–µ–æ** –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

## üîß –ü–û–î–î–ï–†–ñ–ò–í–ê–ï–ú–´–ï –§–û–†–ú–ê–¢–´ –í–ò–î–ï–û
1. **File –æ–±—ä–µ–∫—Ç—ã** (–∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã) - –¥–æ 100MB
2. **Base64 —Å—Ç—Ä–æ–∫–∏** (—Å–∂–∞—Ç—ã–µ –≤–∏–¥–µ–æ) - `data:video/`
3. **URL —Å—Ç—Ä–æ–∫–∏** (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –≤–∏–¥–µ–æ) - `/storage/`, `http`
4. **–û–±—ä–µ–∫—Ç—ã —Å url/preview** (—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)

## üìÅ –°–¢–†–£–ö–¢–£–†–ê –§–ê–ô–õ–û–í
- **–§–∞–π–ª—ã**: `storage/app/public/videos/{user_id}/`
- **URL**: `/storage/videos/{user_id}/filename.ext`
- **–§–æ—Ä–º–∞—Ç—ã**: MP4, AVI, MOV, WMV, FLV, WebM, MKV

## üìö –£–†–û–ö–ò
1. **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏**: photos –∏ video –¥–æ–ª–∂–Ω—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –æ–¥–∏–Ω–∞–∫–æ–≤–æ
2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ**: –º–µ–¥–∏–∞ —Ñ–∞–π–ª—ã –¥–æ–ª–∂–Ω—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ–π –≤ —Å–µ—Ä–≤–∏—Å
3. **–ò–∑–±–µ–∂–∞–Ω–∏–µ –¥–≤–æ–π–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏**: –∏—Å–∫–ª—é—á–∞—Ç—å —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –ø–æ–ª—è –∏–∑ JSON –æ–±—Ä–∞–±–æ—Ç–∫–∏
4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –≤–∞–∂–Ω–æ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤

## üèÜ –°–¢–ê–¢–£–°
**–ü–û–õ–ù–û–°–¢–¨–Æ –†–ï–®–ï–ù–û** - –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Ä–∞–±–æ—Ç—ã —Å –≤–∏–¥–µ–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

## üîó –°–í–Ø–ó–ê–ù–ù–´–ï –†–ï–®–ï–ù–ò–Ø
- [–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É—é—Ç—Å—è](PHOTOS_EDITING_SAVING_SUCCESS.md)
- [–ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏](PHOTOS_COMPLETE_SOLUTION_HISTORY.md)
